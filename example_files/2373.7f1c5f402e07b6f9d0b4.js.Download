"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[2373],{202373:(e,t,i)=>{i.d(t,{linking:()=>g});var n=i(290484),s=i(650151),r=i(735566),o=(i(313266),i(77294)),a=i(666310),l=i(104779),u=i(4944),c=i(804804);var h=i(62802),d=i(588948),y=i(516958),b=i(736800),m=i(897103),_=i(912445);const p=(0,r.getLogger)("Linking");class S{constructor(e,t,i){this.watchedSymbols=new o.WatchedValue([]),this.watchedSymbol=new o.WatchedValue,this.seriesShortSymbol=new o.WatchedValue,this.proSymbol=new o.WatchedValue,this.ensuredProSymbol=new o.WatchedValue,this.watchedInterval=new o.WatchedValue,this.watchedIntraday=new o.WatchedValue,this.watchedSeconds=new o.WatchedValue,this.watchedTicks=new o.WatchedValue,this.watchedDataFrequencyResolution=new o.WatchedValue,this.watchedRange=new o.WatchedValue,this.watchedSupportedResolutions=new o.WatchedValue,this.watchedSupportedChartStyles=new o.WatchedValue,this.symbolNamesList=new o.WatchedValue,this._chartWidgetCollection=null,this._chartWidgetBindingState=0,this._activeChartWidget=null,this._linkingGroupCharts=null,this._boundChartWidget=null,this._watchedSymbolListenerBound=this._watchedSymbolListener.bind(this),this._watchedIntervalListenerBound=this._watchedIntervalListener.bind(this),this._setGroupSymbolCancellationToken={cancelled:!1},this._muted=!1,this.updateBoundChartWidget=()=>{const e=this._chartToBind();e!==this._boundChartWidget&&(null===e?this.unbindFromChartWidget():this.bindToChartWidget(e))},this._updateAllGroupChartWidgets=()=>{this._destroySymbolIntervalPropertySubscriptions?.();const e=(0,s.ensureNotNull)(this._linkingGroupCharts).value(),t=[],i=[];for(const n of e){const e=n.symbolWV().spawn(),s=n.resolutionWV().spawn();e.subscribe(this._updateSymbolByProperty.bind(this,n)),s.subscribe(this._updateIntervalByProperty.bind(this,n)),t.push(e),i.push(s)}this._destroySymbolIntervalPropertySubscriptions=()=>{t.forEach((e=>e.destroy())),i.forEach((e=>e.destroy())),this._destroySymbolIntervalPropertySubscriptions=void 0};const n=this.watchedSymbol.value();e.length>1&&this._needApplySymbol(n)&&!this._muted&&this._setGroupSymbol(n);const r=this.watchedInterval.value();e.length>1&&this._needApplyInterval(r)&&!this._muted&&this._setGroupInterval(r),this.updateBoundChartWidget()},this._groupIndex=e;const n=(e,t)=>{e.subscribe((e=>{i()===this&&t.setValue(e)}),{callWithLast:!0})};n(this.watchedSymbols,t.watchedSymbols),n(this.watchedSymbol,t.watchedSymbol),n(this.seriesShortSymbol,t.seriesShortSymbol),n(this.proSymbol,t.proSymbol),n(this.ensuredProSymbol,t.ensuredProSymbol),n(this.watchedInterval,t.watchedInterval),n(this.watchedIntraday,t.watchedIntraday),n(this.watchedSeconds,t.watchedSeconds),n(this.watchedTicks,t.watchedTicks),n(this.watchedDataFrequencyResolution,t.watchedDataFrequencyResolution),n(this.watchedRange,t.watchedRange),n(this.watchedSupportedResolutions,t.watchedSupportedResolutions),n(this.watchedSupportedChartStyles,t.watchedSupportedChartStyles),n(this.symbolNamesList,t.symbolNamesList),this.watchedSymbol.subscribe((e=>{
this._boundChartWidget&&this._boundChartWidget.hasModel()&&this.mainSeries().symbolSameAsCurrent(e)||this.proSymbol.setValue(e)}),{callWithLast:!0})}mute(e){this._muted=e}bindToChartWidgetCollection(e){this.unbindFromChartWidgetCollection(),this._chartWidgetCollection=e,this._activeChartWidget=e.activeChartWidget.spawn(),this._activeChartWidget.subscribe(this.updateBoundChartWidget),this._linkingGroupCharts=e.linkingGroupsCharts(this._groupIndex).spawn(),this._linkingGroupCharts.subscribe(this._updateAllGroupChartWidgets),this.updateBoundChartWidget(),this._updateAllGroupChartWidgets();const t=function(e){const t=(0,u.combine)((()=>e.getAll().filter((e=>e.isVisible()&&e.hasModel())).map((e=>(0,c.createWVFromGetterAndSubscription)((()=>e.model().mainSeries().symbol()),e.model().mainSeries().symbolResolved()).ownership()))),e.chartModels().weakReference(),e.layout.weakReference());return(0,u.accumulate)((e=>e),t.ownership())}(e);t.subscribe((e=>{this.watchedSymbols.setValue(e)})),this.watchedSymbols.setValue(t.value())}unbindFromChartWidgetCollection(){this.unbindFromChartWidget(),this._chartWidgetCollection=null,this._activeChartWidget?.destroy(),this._activeChartWidget=null,this._linkingGroupCharts?.destroy(),this._linkingGroupCharts=null,this._destroySymbolIntervalPropertySubscriptions?.()}bindToChartWidget(e){if(this.unbindFromChartWidget(),this._boundChartWidget=e,e.hasModel())return void this._onChartModelCreated(e.model());e.modelCreated().subscribe(this,this._onChartModelCreated,!0),this._chartWidgetBindingState=1;const t=e.mainSeriesProperties().childs();this.watchedSymbol.setValue(t.symbol.value()),this.watchedInterval.setValue(t.interval.value()),this._boundChartWidget.linkingGroupIndex().subscribe(this.updateBoundChartWidget)}unbindFromChartWidget(){const e=this._boundChartWidget;if(null!==e){switch(this._chartWidgetBindingState){case 1:e.modelCreated().unsubscribeAll(this);break;case 2:this.watchedSymbol.unsubscribe(this._watchedSymbolListenerBound);const t=this.mainSeries().dataEvents();t.symbolResolved().unsubscribeAll(this),t.symbolError().unsubscribeAll(this),this.mainSeries().onIntervalChanged().unsubscribeAll(this),this.watchedInterval.unsubscribe(this._watchedIntervalListenerBound),delete this.watchedSymbol.writeLock}e.linkingGroupIndex().unsubscribe(this.updateBoundChartWidget),this._boundChartWidget=null,this._chartWidgetBindingState=0}}boundChartWidget(){return this._boundChartWidget}mainSeries(){if(!this._boundChartWidget)throw new Error("ChartWidget is undefined");return this._boundChartWidget.model().mainSeries()}_watchedSymbolListener(e){this._needApplySymbol(e)&&!this._muted&&this._setGroupSymbol(e)}_updateSymbolByProperty(e,t){const i=this._symbolLock();i&&this._needApplySymbol(t)&&!this._muted&&this._setGroupSymbol(t),(i||e===this._boundChartWidget)&&this.watchedSymbol.setValue(t)}_watchedIntervalListener(e){const t=a.Interval.normalize(e);t&&this._needApplyInterval(t)&&!this._muted&&this._setGroupInterval(t)}_updateIntervalByProperty(e,t){
const i=this._intervalLock(),n=a.Interval.normalize(t);i&&n&&this._needApplyInterval(n)&&!this._muted&&this._setGroupInterval(n),(i||e===this._boundChartWidget)&&this.watchedInterval.setValue(n??t)}_updateSeriesSymbolInfo(){this.seriesShortSymbol.setValue((0,s.ensureNotNull)(this._boundChartWidget).getSymbol(!0));const e=this.mainSeries().symbolInfo();if(e){const t=e.pro_name||!1;this.proSymbol.setValue(t||this.watchedSymbol.value()),this.ensuredProSymbol.setValue(this.proSymbol.value()),e.aliases&&this.symbolNamesList.setValue(e.aliases);let i=(0,m.allChartStyles)();((0,l.isCloseBasedSymbol)(e)||this.mainSeries().intervalObj().value().is1Tick())&&(i=i.filter((e=>(0,l.isSingleValueBasedStyle)(e)))),"hlc"===e.visible_plots_set&&(i=i.filter((e=>(0,l.isHLCBasedStyle)(e)||(0,l.isSingleValueBasedStyle)(e)))),this.watchedSupportedChartStyles.setValue(i),this.watchedIntraday.setValue(!!e.has_intraday),this.watchedSeconds.setValue(!!e.has_seconds),this.watchedTicks.setValue(!(0,l.isCloseBasedSymbol)(e)&&!!e["is-tickbars-available"]),this.watchedRange.setValue(!(0,l.isCloseBasedSymbol)(e));const n=e.data_frequency?e.data_frequency:void 0;this.watchedDataFrequencyResolution.setValue(n)}else this.watchedIntraday.setValue(!1),this.watchedSeconds.setValue(!1),this.watchedTicks.setValue(!1),this.watchedRange.setValue(!1),this.mainSeries().isFailed()&&this.ensuredProSymbol.setValue(this.proSymbol.value())}_onChartModelCreated(e){if(!this._boundChartWidget)throw new Error("ChartWidget is undefined");this._chartWidgetBindingState=2,this.watchedSymbol.setValue(this._boundChartWidget.symbolWV().value()),this.watchedSymbol.subscribe(this._watchedSymbolListenerBound);const t=e.mainSeries().dataEvents();t.symbolResolved().subscribe(this,this._updateSeriesSymbolInfo),t.symbolError().subscribe(this,this._updateSeriesSymbolInfo),e.mainSeries().onIntervalChanged().subscribe(this,this._updateSeriesSymbolInfo),this._updateSeriesSymbolInfo(),this.watchedInterval.setValue(this._boundChartWidget.resolutionWV().value()),this.watchedInterval.subscribe(this._watchedIntervalListenerBound),this._boundChartWidget.readOnly()&&(this.watchedSymbol.writeLock=!0)}_chartToBind(){const e=this._chartWidgetCollection;return null===e?null:e.activeChartWidget.value().linkingGroupIndex().value()===this._groupIndex?e.activeChartWidget.value():null!==this._boundChartWidget&&this._boundChartWidget.linkingGroupIndex().value()===this._groupIndex?this._boundChartWidget:e.getAll().find((e=>e.linkingGroupIndex().value()===this._groupIndex))??null}_symbolLock(){return!!this._chartWidgetCollection?.lock.symbol.value()}_intervalLock(){return!!this._chartWidgetCollection?.lock.interval.value()}_chartsForLock(e){return(0===e?this._symbolLock():this._intervalLock())?(0,s.ensureNotNull)(this._linkingGroupCharts).value():this._boundChartWidget?[this._boundChartWidget]:[]}_setGroupSymbol(e){this.mute(!0),this._setGroupSymbolCancellationToken.cancelled=!0;const t=this._setGroupSymbolCancellationToken={cancelled:!1};(0,
s.ensureNotNull)(this._chartWidgetCollection).setSymbol(e,this._groupIndex,(0,s.ensureNotNull)(this._boundChartWidget)).finally((()=>{if(this._boundChartWidget&&!t.cancelled){const t=this._boundChartWidget.model().mainSeries();t.symbolSameAsCurrent(e)||(this.watchedSymbol.setValue(t.symbol()),this.proSymbol.setValue(t.proSymbol()))}})),this.mute(!1)}_needApplySymbol(e){const t=this._chartsForLock(0),i=t.find((t=>t.hasModel()&&t.model().mainSeries().symbolInfo()&&t.model().mainSeries().symbolSameAsResolved(e)));if(i){const e=i.model().mainSeries();if(t.every((t=>e.symbolSameAsResolved(t.symbolWV().value()))))return!1}return t.some((t=>t.symbolWV().value()!==e))}_setGroupInterval(e){this.mute(!0),(0,s.ensureNotNull)(this._chartWidgetCollection).setResolution(e,this._groupIndex).finally((()=>{if(this._boundChartWidget){const t=this._boundChartWidget.resolutionWV().value();a.Interval.isEqual(t,e)||this.watchedInterval.setValue(t)}})),this.mute(!1)}_needApplyInterval(e){return this._chartsForLock(1).some((t=>!a.Interval.isEqual(t.resolutionWV().value(),e)))}}const g=new class{constructor(){this._watchedSymbols=new o.WatchedValue([]),this._watchedSymbol=new o.WatchedValue,this._seriesShortSymbol=new o.WatchedValue,this._proSymbol=new o.WatchedValue,this._ensuredProSymbol=new o.WatchedValue,this._watchedInterval=new o.WatchedValue,this._watchedIntraday=new o.WatchedValue,this._watchedSeconds=new o.WatchedValue,this._watchedTicks=new o.WatchedValue,this._watchedDataFrequencyResolution=new o.WatchedValue,this._watchedRange=new o.WatchedValue,this._watchedSupportedResolutions=new o.WatchedValue,this._watchedSupportedChartStyles=new o.WatchedValue([]),this._symbolNamesList=new o.WatchedValue,this._chartWidgetCollection=null,this._onSymbolLinkBound=this._onSymbolLink.bind(this),this._searchCharts=null,this._searchChartsLoadDebounced=null,this._selfEmit=!1,this._preventFeedBySymbol=!1,this._feedBySymbolDebounceCounter=0,this._linkingGroups=new Map,this._activeLinkingGroup=new o.WatchedValue,this._activeLinkingGroupIndex=null,this._updateLinkingGroups=()=>{(0,s.ensureNotNull)(this._chartWidgetCollection).allLinkingGroups().value().forEach((e=>this._linkingGroup(e))),this._linkingGroups.forEach((e=>e.updateBoundChartWidget()))},this._activeLinkingGroup.setValue(this._linkingGroup(null));const e=(e,t)=>{e.subscribe((e=>t().setValue(e)),{callWithLast:!0})};e(this._watchedSymbols,(()=>this._activeLinkingGroup.value().watchedSymbols)),e(this._watchedSymbol,(()=>this._activeLinkingGroup.value().watchedSymbol)),e(this._seriesShortSymbol,(()=>this._activeLinkingGroup.value().seriesShortSymbol)),e(this._proSymbol,(()=>this._activeLinkingGroup.value().proSymbol)),e(this._ensuredProSymbol,(()=>this._activeLinkingGroup.value().ensuredProSymbol)),e(this._watchedInterval,(()=>this._activeLinkingGroup.value().watchedInterval)),e(this._watchedIntraday,(()=>this._activeLinkingGroup.value().watchedIntraday)),e(this._watchedSeconds,(()=>this._activeLinkingGroup.value().watchedSeconds)),
e(this._watchedTicks,(()=>this._activeLinkingGroup.value().watchedTicks)),e(this._watchedDataFrequencyResolution,(()=>this._activeLinkingGroup.value().watchedDataFrequencyResolution)),e(this._watchedRange,(()=>this._activeLinkingGroup.value().watchedRange)),e(this._watchedSupportedResolutions,(()=>this._activeLinkingGroup.value().watchedSupportedResolutions)),e(this._watchedSupportedChartStyles,(()=>this._activeLinkingGroup.value().watchedSupportedChartStyles)),e(this._symbolNamesList,(()=>this._activeLinkingGroup.value().symbolNamesList));const t=e=>{this._watchedSymbol.setValue(e.watchedSymbol.value()),this._seriesShortSymbol.setValue(e.seriesShortSymbol.value()),this._proSymbol.setValue(e.proSymbol.value()),this._ensuredProSymbol.setValue(e.ensuredProSymbol.value()),this._watchedInterval.setValue(e.watchedInterval.value()),this._watchedIntraday.setValue(e.watchedIntraday.value()),this._watchedSeconds.setValue(e.watchedSeconds.value()),this._watchedTicks.setValue(e.watchedTicks.value()),this._watchedDataFrequencyResolution.setValue(e.watchedDataFrequencyResolution.value()),this._watchedRange.setValue(e.watchedRange.value()),this._watchedSupportedResolutions.setValue(e.watchedSupportedResolutions.value()),this._watchedSupportedChartStyles.setValue(e.watchedSupportedChartStyles.value()),this._symbolNamesList.setValue(e.symbolNamesList.value())};this._activeLinkingGroup.subscribe(t),t(this._activeLinkingGroup.value()),(0,_.setMuteLinkingGroup)(((e,t)=>{"all"===e?this._linkingGroups.forEach((e=>e.mute(t))):this._linkingGroup(e).mute(t)}))}get symbols(){return this._watchedSymbols}get symbol(){return this._watchedSymbol}get proSymbol(){return this._proSymbol.readonly()}get ensuredProSymbol(){return this._ensuredProSymbol.readonly()}get symbolNamesList(){return this._symbolNamesList.readonly()}get seriesShortSymbol(){return this._seriesShortSymbol.readonly()}get interval(){return this._watchedInterval}get intraday(){return this._watchedIntraday.readonly()}get seconds(){return this._watchedSeconds.readonly()}get ticks(){return this._watchedTicks.readonly()}get range(){return this._watchedRange.readonly()}get supportedResolutions(){return this._watchedSupportedResolutions.readonly()}get supportedChartStyles(){return this._watchedSupportedChartStyles.readonly()}get preventFeedBySymbol(){return this._preventFeedBySymbol}get dataFrequencyResolution(){return this._watchedDataFrequencyResolution.readonly()}activeLinkingGroup(){return this._activeLinkingGroup.readonly()}getChartWidget(){return this.activeLinkingGroup().value().boundChartWidget()}bindToChartWidgetCollection(e){this._chartWidgetCollection?.onAboutToBeDestroyed.unsubscribeAll(this),this._unbindFromChartWidgetCollection(),this._chartWidgetCollection=e,this._chartWidgetCollection.onAboutToBeDestroyed.subscribe(this,this._unbindFromChartWidgetCollection),this._chartWidgetCollection.allLinkingGroups().subscribe(this._updateLinkingGroups),this._updateLinkingGroups(),this._activeLinkingGroupIndex=e.activeLinkingGroup().spawn(),
this._activeLinkingGroupIndex.subscribe((e=>{this._activeLinkingGroup.setValue(this._linkingGroup(e))}),{callWithLast:!0}),this._linkingGroups.forEach((t=>t.bindToChartWidgetCollection(e)))}bindToSearchCharts(e){this.unbindFromSearchCharts(),this._searchCharts=e,e.onSearchBySymbol.subscribe(this,this._onSearchBySymbol),e.loadingSymbol.subscribe((e=>{!1===e&&(this._feedBySymbolDebounceCounter=0)})),this._watchedSymbol.subscribe(this._onSymbolLinkBound)}unbindFromSearchCharts(){this._searchCharts&&(this._searchCharts.onSearchBySymbol.unsubscribe(this,this._onSearchBySymbol),this._watchedSymbol.unsubscribe(this._onSymbolLinkBound),this._searchCharts=null)}setPreventFeedBySymbol(e){this._preventFeedBySymbol=e}setSymbolAndLogInitiator(e,t,i,n=!1){(this.symbol.value()!==e||i)&&(p.logInfo(`Change linking symbol to ${e}, initiator: ${t}`),this.symbol.setValue(e,i),n||null===this._chartWidgetCollection||(0,y.trackChangeSymbol)(this.activeLinkingGroup().value().mainSeries(),this._chartWidgetCollection.layout.value(),this._chartWidgetCollection.metaInfo.uid.value()||"",t))}setIntervalAndLogInitiator(e,t){a.Interval.isEqual(this.interval.value(),e)||((0,b.trackIntervalChanging)(e,t),this.interval.setValue(e))}_onSearchBySymbol(e){if(!e.resolved_symbol)throw new Error("no resolved_symbol");this._selfEmit=!0,this._watchedSymbol.setValue(e.resolved_symbol),this._selfEmit=!1}_onSymbolLink(e){if(!this._selfEmit){if(!this._searchCharts){const e="No search charts defined";throw p.logError(e),new Error(e)}this._preventFeedBySymbol||this._loadSearchCharts(e)}}_loadSearchCharts(e){if(!this._searchCharts){const e="No search charts defined";throw p.logError(e),new Error(e)}if(this._searchChartsLoadDebounced)return void(this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced(e)));const t=e=>this._searchCharts?(!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,n.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchChartsLoadDebounced=null,this._searchCharts.feedBySymbol.call(this._searchCharts,e)):()=>{};!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,n.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchCharts.feedBySymbol(e)}_linkingGroup(e){let t=this._linkingGroups.get(e);if(void 0===t){const i={watchedSymbols:this._watchedSymbols,watchedSymbol:this._watchedSymbol,seriesShortSymbol:this._seriesShortSymbol,proSymbol:this._proSymbol,ensuredProSymbol:this._ensuredProSymbol,watchedInterval:this._watchedInterval,watchedIntraday:this._watchedIntraday,watchedSeconds:this._watchedSeconds,watchedTicks:this._watchedTicks,watchedDataFrequencyResolution:this._watchedDataFrequencyResolution,watchedRange:this._watchedRange,watchedSupportedResolutions:this._watchedSupportedResolutions,watchedSupportedChartStyles:this._watchedSupportedChartStyles,
symbolNamesList:this._symbolNamesList};t=new S(e,i,(()=>this._activeLinkingGroup.value())),this._linkingGroups.set(e,t),this._chartWidgetCollection&&t.bindToChartWidgetCollection(this._chartWidgetCollection)}return t}_unbindFromChartWidgetCollection(){null!==this._chartWidgetCollection&&(this._activeLinkingGroupIndex?.destroy(),this._activeLinkingGroupIndex=null,this._linkingGroups.forEach((e=>e.unbindFromChartWidgetCollection())),this._chartWidgetCollection.allLinkingGroups().unsubscribe(this._updateLinkingGroups),this._chartWidgetCollection=null)}};{const e=(0,d.getFreshInitData)().symbolInfo,t=e?e.pro_symbol:h.getValue("editchart.model.symbol",window.DEFAULT_SYMBOL);g.setSymbolAndLogInitiator(t,"initial data",!1,!0)}window.TradingViewApi||(window.TradingViewApi={linking:g})},912445:(e,t,i)=>{let n;function s(e,t){n?.(e,t)}function r(e){n=e}i.d(t,{muteLinkingGroup:()=>s,setMuteLinkingGroup:()=>r})},147582:(e,t,i)=>{i.d(t,{sparseUsersTrackingCoefficient:()=>a});var n=i(49437);const s="sparseUsersTrackingCoefficient",r=(0,i(66974).isProd)()?null:n.TVLocalStorage.getItem(s);let o=null!==r?parseFloat(r):null;null!==o&&(!Number.isFinite(o)||o<0||o>1)&&(o=null,n.TVLocalStorage.removeItem(s));const a=o??.1},516958:(e,t,i)=>{i.d(t,{trackChangeSymbol:()=>a});var n=i(503447),s=i(484498),r=i(473552),o=i(776734);function a(e,t,i,a){window.user.do_not_track||e.symbolResolvingActive().subscribe((l=>{if(l)return;const u=e.symbolInfo();u&&(0,o.getTracker)().then((o=>{null!==o&&o.trackChartSymbols({symbolName:u.pro_name,symbolType:u.type,resolution:e.interval(),layoutType:t,chartId:i,chartStyles:n.STYLE_SHORT_NAMES[e.style()],openSource:a,platform:(0,s.getPlatform)(),isExpert:window.user.declared_status===r.UserStatus.Pro})}))}),{once:!0})}},736800:(e,t,i)=>{i.d(t,{trackIntervalChanging:()=>a});var n=i(584878),s=i(776734),r=i(147582);const o="IntervalChanging";function a(e,t){window.user.do_not_track||(0,n.shouldAffectUser)(o,r.sparseUsersTrackingCoefficient)&&(0,s.getTracker)().then((i=>{null!==i&&i.trackChartIntervalChanging(e,t)}))}},4944:(e,t,i)=>{i.d(t,{accumulate:()=>a,combine:()=>o,combineWithFilteredUpdate:()=>r});var n=i(158942);function s(e,t,...i){let s=null;const r=(...t)=>e(...t.map((e=>e.value())),s?.value()),o=s=new n.WatchedValue(r(...i)),a=()=>{const e=i.map(((e,t)=>e.value()));t(...e)&&o.setValue(r(...i))},l=i.map((e=>e.spawn()));for(const e of l)e.subscribe(a);return o.readonly().spawn((()=>{l.forEach((e=>e.destroy())),i.forEach((e=>e.release()))}))}function r(e,t,...i){return s(e,t,...i)}function o(e,...t){return s(e,(()=>!0),...t)}function a(e,t,...i){let s=null;const r=o(((...e)=>(e.splice(-1),e)),...i),a=t.spawn(),l=(t,...i)=>{const n=t.map((e=>e.value()));return e(n,...i,s?.value())},u=s=new n.WatchedValue(l(a.value(),...r.value()));let c=[];const h=()=>{u.setValue(l(c,...r.value()))},d=e=>{c.forEach((e=>e.destroy())),c=e.map((e=>e.spawn())),c.forEach((e=>e.subscribe(h))),h()};d(a.value()),a.subscribe(d),r.subscribe(h);return u.readonly().spawn((()=>{c.forEach((e=>e.destroy())),a.destroy(),r.destroy(),
t.release()}))}},796114:(e,t,i)=>{i.d(t,{isCFDSymbol:()=>s,isCryptoSymbol:()=>c,isFuturesSymbol:()=>a,isIndexCFDSymbol:()=>r,isIndexSymbol:()=>u,isNDFSymbol:()=>o,isStockSymbol:()=>l});const n=["commodity","futures","index","stock","fund"];function s(e,t){return Boolean(t?.includes("cfd"))&&["commodity","futures","index","stock","fund"].includes(e)}function r(e,t){return"index"===e&&Boolean(t?.includes("cfd"))}function o(e,t){return n.includes(e)&&(t?.includes("ndf")??!1)}function a(e,t){return"futures"===e&&void 0!==t&&!t.includes("cfd")&&!t.includes("ndf")}function l(e,t){return"stock"===e&&void 0!==t&&!t.includes("cfd")&&!t.includes("ndf")}function u(e,t){return void 0!==t&&("index"===e&&!t.includes("cfd")&&!t.includes("ndf")||"fundamental"===e&&t.includes("crypto"))}function c(e){return void 0!==e&&e.includes("crypto")}},897103:(e,t,i)=>{i.d(t,{allChartStyles:()=>r});var n=i(313266);const s=(0,i(638456).onWidget)();function r(){return function(){const e=[0,1,9,13,2,14,15,3,16,10];return e.push(12),s||e.push(17),s||e.push(18),s||e.push(20),s||e.push(19),e}().concat(function(){const e=[8];return(0,n.isFeaturesetEnabled)("japanese_chart_styles")&&(e.push(4,7,5,6),e.push(11)),e}())}},442050:(e,t,i)=>{i.d(t,{extractSymbolNameFromSymbolInfo:()=>l});var n=i(313266);const s=(0,n.isFeaturesetEnabled)("pay_attention_to_ticker_not_symbol"),r=(0,n.isFeaturesetEnabled)("charting_library_single_symbol_request"),o=(0,n.isFeaturesetEnabled)("use_ticker_on_symbol_info_update"),a=(0,n.isFeaturesetEnabled)("uppercase_instrument_names");function l(e,t,i,n){let l=e&&(i&&e.pro_name||e.full_name||e.name);return r&&t?l=t:(o||!n&&s)&&e&&e.ticker&&(l=e.ticker),a&&l&&(l=l.toUpperCase()),l}},920713:(e,t,i)=>{i.d(t,{combineProperty:()=>s});var n=i(673378);function s(e,...t){const i=()=>e(...t.map((e=>e.value()))),s=(0,n.createPrimitiveProperty)(i()),r=()=>s.setValue(i()),o={};for(const e of t)e.subscribe(o,r);return s.destroy=()=>{t.forEach((e=>e.unsubscribeAll(o))),t.forEach((e=>e.release()))},s}},771594:(e,t,i)=>{i.d(t,{createPrimitivePropertyFromGetterAndSubscription:()=>s});var n=i(673378);function s(e,t){const i=(0,n.createPrimitiveProperty)(e()),s={};return i.destroy=()=>{t.unsubscribeAll(s)},t.subscribe(s,(()=>{i.setValue(e())})),i}},157432:(e,t,i)=>{i.d(t,{combineProperty:()=>a.combineProperty,createPrimitivePropertyFromGetterAndSubscription:()=>o.createPrimitivePropertyFromGetterAndSubscription,createWVFromGetterAndSubscription:()=>n.createWVFromGetterAndSubscription,createWVFromGetterAndSubscriptions:()=>s.createWVFromGetterAndSubscriptions,createWVFromProperty:()=>r.createWVFromProperty});var n=i(804804),s=i(791638),r=i(707292),o=i(771594),a=i(920713)},804804:(e,t,i)=>{i.d(t,{createWVFromGetterAndSubscription:()=>s});var n=i(77294);function s(e,t){const i=new n.WatchedValue(e()),s={};t.subscribe(s,(()=>{i.setValue(e(i.value()))}));return i.readonly().spawn((()=>t.unsubscribeAll(s)))}},791638:(e,t,i)=>{i.d(t,{createWVFromGetterAndSubscriptions:()=>s});var n=i(77294);function s(e,t){const i=new n.WatchedValue(e()),s={}
;t.forEach((t=>t.subscribe(s,(()=>{i.setValue(e())}))));return i.readonly().spawn((()=>t.forEach((e=>e.unsubscribeAll(s)))))}},707292:(e,t,i)=>{i.d(t,{createWVFromProperty:()=>s});var n=i(804804);function s(e){return(0,n.createWVFromGetterAndSubscription)((()=>e.value()),e)}},104779:(e,t,i)=>{i.d(t,{actualSymbol:()=>pe,chartStyleStudyId:()=>U,createSeriesFormatter:()=>$,displayedSymbolExchange:()=>_e,displayedSymbolName:()=>me,extractLineToolSymbolFromSymbolInfo:()=>ce,getChartStyleByResolution:()=>N,getDefaultStyle:()=>M,getLastUsedRawDataStyle:()=>D,getLastUsedSingleValueBasedStyle:()=>x,getLastUsedStyle:()=>P,getSeriesDisplayErrorWV:()=>Fe,getSeriesPriceFormattingState:()=>H,getSourceForEconomySymbol:()=>ye,getSymbolDelaySeconds:()=>Be,getSymbolListedExchange:()=>Ve,getSymbolTradedExchange:()=>Ie,getTranslatedChartStyleName:()=>C,hasVolume:()=>Ce,isCloseBasedSymbol:()=>ve,isConvertedToOtherCurrency:()=>K,isConvertedToOtherMetric:()=>ne,isConvertedToOtherUnit:()=>ie,isEconomicSymbol:()=>We,isFutureContinuousSymbolWithBackajustment:()=>Le,isFuturesContractSymbol:()=>Ge,isHLCBasedStyle:()=>R,isMeasureUnitSymbol:()=>we,isMetricActive:()=>se,isPriceSourceStyle:()=>O,isRangeBasedStyle:()=>k,isRangeStyle:()=>I,isRawDataStyle:()=>E,isRegularSessionId:()=>ge,isRequiringRestartSeriesStyles:()=>W,isSingleValueBasedStyle:()=>B,isSpreadSymbolWithManyLegs:()=>ke,isStyleSupportedForReplay:()=>G,isTimeBasedStyle:()=>L,isValidStyle:()=>F,measureUnitId:()=>fe,preparePriceAxisProperties:()=>q,proSymbol:()=>Se,setLastUsedRawDataStyle:()=>A,setLastUsedStyle:()=>T,styleChangeRequiresRestart:()=>V,symbolBaseCurrency:()=>J,symbolCurrency:()=>z,symbolCurrencyConvertible:()=>j,symbolHasEconomicEvents:()=>ue,symbolHasElectronicSession:()=>ae,symbolHasPreOrPostMarket:()=>oe,symbolHasSeveralSessions:()=>le,symbolMetric:()=>ee,symbolOriginalCurrency:()=>Y,symbolOriginalMetric:()=>te,symbolOriginalUnit:()=>Z,symbolTitle:()=>be,symbolTitleSeparator:()=>de,symbolToSaveInState:()=>he,symbolUnit:()=>X,symbolUnitConvertibleGroupsIfExist:()=>re});var n=i(444372),s=i(313266),r=i(62802),o=i(638456),a=i(519073),l=i(503447),u=i(666310),c=i(339563),h=i(235614),d=i(754032),y=i(796114),b=i(4944),m=i(157432),_=i(442050);const p=(0,s.isFeaturesetEnabled)("uppercase_instrument_names"),S=(0,s.isFeaturesetEnabled)("hide_object_tree_and_price_scale_exchange_label"),g=[4,5,6,7,8],v=[4,5,6,7,11],w=[0,1,9,19,2,14,15,3,16,21,10,8,12,13,18,17,20],f=[2,14,15,10,3,13,18];function C(e){return{0:n.t(null,void 0,i(527377)),1:n.t(null,void 0,i(745054)),2:n.t(null,void 0,i(903554)),14:n.t(null,void 0,i(409394)),15:n.t(null,void 0,i(869217)),3:n.t(null,void 0,i(534456)),16:n.t(null,void 0,i(99906)),9:n.t(null,void 0,i(913459)),10:n.t(null,void 0,i(259213)),12:n.t(null,void 0,i(498236)),13:n.t(null,void 0,i(655761)),4:n.t(null,void 0,i(188130)),7:n.t(null,void 0,i(743588)),5:n.t(null,void 0,i(383490)),6:n.t(null,void 0,i(276519)),11:n.t(null,void 0,i(855169)),8:n.t(null,void 0,i(863876)),17:n.t(null,void 0,i(292763)),18:n.t(null,void 0,i(617809)),19:n.t(null,void 0,i(193722)),
20:n.t(null,void 0,i(383298)),21:n.t(null,void 0,i(800886))}[e]}function W(e){return-1!==g.indexOf(e)}function k(e){return-1!==v.indexOf(e)}function V(e,t){return!I(e)&&!I(t)&&!(e===t||!W(e)&&!W(t))}function I(e){return 11===e}function L(e){return-1!==w.indexOf(e)}function G(e){return 17!==e&&18!==e&&20!==e&&L(e)}function F(e){return k(e)||L(e)}function B(e){switch(e){case 3:case 10:case 2:case 14:case 15:case 13:return!0;default:return!1}}function R(e){switch(e){case 16:case 21:return!0;default:return!1}}function E(e){return!l.SYMBOL_STRING_DATA[e]}function T(e,t){F(e)&&(11!==e&&r.setValue("chart.lastUsedStyle",e),E(e)&&A(e),ve(t)&&B(e)&&r.setValue("chart.lastUsedSingleValueBasedStyle",e))}function A(e){r.setValue("chart.rawDataStyle",e)}function P(){const e=r.getInt("chart.lastUsedStyle");return void 0===e?1:e}function x(){const e=r.getInt("chart.lastUsedSingleValueBasedStyle");return void 0===e?14:e}function D(){return r.getInt("chart.rawDataStyle",1)}function M(e){return e?11:1}function N(e,t){const i=I(t),n=u.Interval.isRange(e);return!i&&n?M(!0):i&&!n?M(!1):t}function U(e,t,i){const n=l.SYMBOL_STRING_DATA[e];if(void 0===n)return null;const s=(0,l.isChartStyleStudyInfoComplex)(n)?n.selector(i??{}):n;return t?`${s.type}-${s.basicStudyVersion}`:s.type}function q(e){const t=e.priceAxisProperties,i=t.lockScale.value(),n=6===e.style.value();(n||i)&&(t.log.setValue(!1),t.percentage.setValue(!1)),t.logDisabled.setValue(!(!n&&!i)),t.percentageDisabled.setValue(!(!n&&!i))}function O(e){return f.includes(e)}function H(e,t="default",i=!1){let n,s,r,o,a=100,l=1;if("default"===t)null!=e&&(({pricescale:a,minmov:l,minmove2:s,fractional:n}=e),r=e.variable_tick_size||void 0);else{let e=t.split(",");3!==e.length&&(e=["100","1","false"]),a=parseInt(e[0]),l=parseInt(e[1]),n="true"===e[2],o=!0}return i&&(l=1),{priceScale:a,minMove:l,fractional:n,minMove2:s,variableMinTick:r,ignoreMinMove:i,noExponentialForm:o}}function $(e,t,i=!1){const{priceScale:n,minMove:s,fractional:r,minMove2:o,variableMinTick:a,noExponentialForm:l}=H(e,t,i);if(null!=e){const l=e.format;if("default"===t&&"volume"===l)return new h.VolumeFormatter({precision:2});if("percent"===l)return new d.PercentageFormatter({priceScale:n,minMove:s,fractional:r,minMove2:o,variableMinTick:a,ignoreMinMove:i})}return new c.PriceFormatter({priceScale:n,minMove:s,fractional:r,minMove2:o,variableMinTick:a,ignoreMinMove:i,noExponentialForm:l})}function j(e){return null!==e&&!(0,a.isSpread)(e.type)}function z(e,t,i){if(null===e)return null;const n=!t||i?e.currency_id:e.currency_code;return void 0===n||""===n||"pct"===n?null:n}function Y(e,t){const i=t?e.original_currency_code:e.original_currency_id;return"pct"===i?null:i??z(e,t)}function J(e){return e.base_currency_id||null}function K(e){if(null===e||!j(e))return!1;const t=Y(e);return null!==t&&t!==z(e)}function Q(e,t){return t&&null!==e&&!(0,a.isSpread)(e.type)}function X(e,t){if(null===e||!t)return null;const i=e.unit_id;return void 0===i||""===i?null:i}function Z(e,t){return t?e.original_unit_id||X(e,t):null}function ee(e,t){
return t&&e.metrics?.current||null}function te(e,t){return t?e.metrics?.default||ee(e,t):null}function ie(e,t){return!(null===e||!Q(e,t))&&(void 0!==e.original_unit_id&&e.original_unit_id!==e.unit_id)}function ne(e,t){return!(null===e||!t)&&(void 0!==e?.metrics?.default&&e?.metrics?.default!==e?.metrics?.current)}function se(e){return Boolean(e?.metrics?.current&&"price"!==e.metrics.current)}function re(e,t){return null!==e&&Q(e,t)?e.unit_conversion_types||null:[]}function oe(e){return null!==e&&void 0!==e.subsessions&&e.subsessions.some((e=>"premarket"===e.id||"postmarket"===e.id))}function ae(e){return null!==e&&void 0!==e.subsessions&&(e.subsessions.some((e=>"regular"===e.id))&&e.subsessions.some((e=>"us_regular"===e.id)))}function le(e){return null!==e&&void 0!==e.subsessions&&e.subsessions.filter((e=>!e.private)).length>1}function ue(e){return null!==e&&((0,a.isForexSymbol)(e.type)||(0,y.isCFDSymbol)(e.type,e.typespecs)||(0,a.hasCryptoTypespec)(e.typespecs||[]))}function ce(e,t){return(0,_.extractSymbolNameFromSymbolInfo)(e,null,!0,!0)||t}function he(e,t){return e?e.ticker??e.pro_name??t:t}const de="Â·";function ye(e,t){return We(e)?e.source2?.description??null:null}function be(e,t){const i=Ve(e);return t||S?e.name:`${e.name} ${de} ${i}`}function me(e){let t=e&&(function(e){return(0,a.isFutures)(e.type)&&e.front_contract||null}(e)||e.name)||"";return t.length>40&&(t=t.substring(0,37)+"..."),t.trim()}function _e(e){const t=e?e.exchange:"";return p?t.toUpperCase():t}function pe(e,t){return null!==e?e.full_name:t}function Se(e,t){return e?.pro_name??t}function ge(e,t){return["stock","fund","index","dr"].includes(t.type)&&"regular"===e||(0,a.isFutures)(t.type)&&"us_regular"===e}function ve(e){return"c"===e?.visible_plots_set}function we(e){return null!==e&&("unit"===e.measure&&null!==fe(e))}function fe(e){return e?.value_unit_id??null}function Ce(e){return"ohlcv"===e.visible_plots_set}function We(e){return null!==e&&(0,a.isEconomicSymbol)(e.type)}function ke(e){return function(e){return null!==e&&(0,a.isSpread)(e.type)}(e)&&(e?.legs??[]).length>1}function Ve(e){const t=ye(e);if(null!==t)return t;return(0,o.onWidget)()||(0,a.isForexSymbol)(e.type)?e.exchange:e.exchange_listed_name??e.exchange}function Ie(e){return e.exchange}function Le(e){return null!==e&&(0,a.isFutures)(e.type)&&Boolean(e.has_backadjustment&&e.typespecs?.includes("continuous"))}function Ge(e){return null!==e&&(0,a.isFutures)(e.type)&&!Boolean(e.typespecs?.includes("continuous"))}function Fe(e){return(0,b.combine)(((t,i,n)=>{switch(t){case 4:{const t=e.seriesErrorMessage();return null!==t&&("resolution_not_entitled"===t||"custom_resolution"===t||"seconds_not_entitled"===t||"ticks_not_entitled"===t||t.startsWith("study_not_auth:"))?null:{type:"invalid_symbol"}}case 13:{const t=e.seriesErrorMessage();return null===t?null:{type:"calculations_error",errorMessage:t}}case 14:{const t=e.unsupportedResolutionState().value();return null===t?null:{type:"unsupported_resolution",reason:t.reason}}case 1:case 2:return null;default:if(i&&null!==n)return n?{
type:"ipo_priced"}:{type:"no_data"}}return null}),e.statusWV().weakReference(),(0,m.createWVFromGetterAndSubscription)((()=>!e.bars().size()&&!e.nsBars().size()&&!e.isInReplay().value()),e.dataEvents().dataUpdated()).ownership(),(0,b.combine)(((e,t)=>t?"priced"===e?.ipo_offer_status:null),e.quotesProvider().quotes().weakReference(),e.quotesProvider().completed().weakReference()).ownership())}function Be(e){return Math.max(0,e?.delay??0)}}}]);