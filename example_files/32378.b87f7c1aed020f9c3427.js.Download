"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[32378],{581996:(e,t,s)=>{s.d(t,{ResizerDetacherState:()=>r});var n=s(650151),i=s(77294);class r{constructor(e){this._alive=new i.WatchedValue,this._container=new i.WatchedValue,this._width=new i.WatchedValue,this._height=new i.WatchedValue,this._fullscreen=new i.WatchedValue,this._detachable=new i.WatchedValue,this._fullscreenable=new i.WatchedValue,this._visible=new i.WatchedValue,this._availWidth=new i.WatchedValue,this._availHeight=new i.WatchedValue,this._owner=new i.WatchedValue,this._ownersStack=[],this.owner=this._owner.readonly(),this._bridge={alive:this._alive.readonly(),container:this._container.readonly(),width:this._width.readonly(),height:this._height.readonly(),fullscreen:this._fullscreen.readonly(),detachable:this._detachable.readonly(),fullscreenable:this._fullscreenable.readonly(),visible:this._visible.readonly(),availWidth:this._availWidth.readonly(),availHeight:this._availHeight.readonly(),remove:()=>{const e=this._owner.value();e&&e.remove&&e.remove()},negotiateWidth:e=>{const t=this._owner.value();t&&t.negotiateWidth&&t.negotiateWidth(e)},negotiateHeight:e=>{const t=this._owner.value();t&&t.negotiateHeight&&t.negotiateHeight(e)},requestFullscreen:()=>{const e=this._owner.value();e&&e.requestFullscreen&&e.requestFullscreen()},exitFullscreen:()=>{const e=this._owner.value();e&&e.exitFullscreen&&e.exitFullscreen()},detach:e=>{const t=this._owner.value();t&&t.detach&&t.detach(e)},attach:()=>{const e=this._owner.value();e&&e.attach&&e.attach()}},e&&this.pushOwner(e)}destroy(){for(const e of this._ownersStack)this._unsubscribeOwner(e)}bridge(){return this._bridge}pushOwner(e){if(!e.alive.value())return;for(const e of this._ownersStack)this._unsubscribeOwner(e);const t={owner:e};this._ownersStack.push(t),this._subscribeOwner(t)}_subscribeOwner(e){const t=e.owner;if(e.deathWatcher||(this._alive.setValue(!0),e.deathWatcher=t.alive.spawn(),e.deathWatcher.subscribe((t=>{t||this._deadHandler(e)}))),this._owner.setValue(t),!e.subscriptions){const s=e.subscriptions=[];this._visible.setValue(!1);const n=(e,t)=>{if(e){const n=e.spawn();s.push(n),n.subscribe((e=>{t.setValue(e)}),{callWithLast:!0})}else t.deleteValue()};n(t.container,this._container),n(t.width,this._width),n(t.height,this._height),n(t.fullscreen,this._fullscreen),n(t.detachable,this._detachable),n(t.fullscreenable,this._fullscreenable),n(t.availWidth,this._availWidth),n(t.availHeight,this._availHeight),n(t.visible,this._visible)}}_unsubscribeOwner(e,t){if(e.subscriptions){for(const t of e.subscriptions)t.unsubscribe();e.subscriptions=null}t&&e.deathWatcher&&(e.deathWatcher.unsubscribe(),e.deathWatcher=null)}_deadHandler(e){const t=this._ownersStack.indexOf(e);(0,n.assert)(-1!==t,"sanitized owner should be in stack");for(let e=this._ownersStack.length-1;e>=t;e--)this._unsubscribeOwner(this._ownersStack[e],!0);this._ownersStack.length=t,t>0?this._subscribeOwner(this._ownersStack[t-1]):(this._alive.setValue(!1),this._owner.deleteValue())}}},554433:(e,t,s)=>{s.d(t,{
VisibilityApi:()=>i});var n=s(77294);class i{constructor(e){let t;this.isVisible=new n.WatchedValue(!0);let s=null;for(const n of["","moz","ms","webkit"]){const i=n?`${n}Hidden`:"hidden";if(i in e){t=`${n}visibilitychange`,s=()=>{this.isVisible.setValue(!e[i])},s(),e.addEventListener(t,s,!1);break}}this.destroy=()=>{s&&(e.removeEventListener(t,s,!1),s=null)}}}},347402:(e,t,s)=>{s.d(t,{desktopVersionIsLess:()=>a,lessThan:()=>r});var n=s(638456);function i(e){const t=e.match(/^(\d+).(\d+).(\d+)/);if(!t)return null;const[,s,n,i]=t;return[parseInt(s),parseInt(n),parseInt(i)]}function r(e,t){const s=i(e),n=i(t);if(!s||!n)return!1;const[r,a,o]=s,[h,c,l]=n;return r!==h?r<h:a!==c?a<c:o!==l&&o<l}function a(e){const t=(0,n.desktopAppVersion)();return!!t&&r(t,e)}},262078:(e,t,s)=>{s.r(t),s.d(t,{pushStreamMultiplexer:()=>L});var n=s(226722),i=s(345848),r=s(49437),a=s(666054),o=s(175203),h=s(735566),c=s(650151),l=s(798266),u=s(420021);class d{constructor(e){this._queue=[],this._isWorking=!1,this._onResolve=()=>{this._queue.length>0&&this._createPromise(this._queue[0])},this._logger=e}enqueue(e){this._logger.logNormal(`Adding channel in stack. Queue size: ${this._queue.length}`),this._isWorking||this._createPromise(e),this._queue.push(e)}_createPromise(e){this._isWorking=!0,this._wrap(e).then(this._onResolve)}_wrap(e){return new Promise((t=>{e().catch((e=>this._logger.logNormal(`Error when trying handling channel: ${e.message}`))).finally((()=>{this._isWorking=!1,this._queue.shift(),t()}))}))}}const _="PushStream",m=(0,h.getLogger)(_);var p;!function(e){e[e.EventSource=0]="EventSource",e[e.WebSocket=1]="WebSocket"}(p||(p={}));class g{constructor(e,t){this._channels=[],this._queue=new d(m),this._transport=t.transportType===p.EventSource?new l.PersistentEventSourceTransport(this._onPushStreamMessage.bind(this)):new u.PersistentWebsocketTransport(this._onPushStreamMessage.bind(this),this._onPushStreamClose.bind(this)),this._settings=t,this._messageHandler=e}addChannel(e){this._queue.enqueue((()=>this._addChannel(e)))}removeChannel(e){this._queue.enqueue((()=>this._removeChannel(e)))}getChannels(){return this._channels}hasChannel(e){return-1!==this._channels.indexOf(e)}connectionStatus(){return this._transport.connectionStatus()}reconnectEvent(){return this._transport.successReconnectReachedEvent()}connect(){(0,c.assert)(0!==this._channels.length,"There is no channels"),this._transport.connect()}disconnect(){this._transport.disconnect()}getLogs(e){return(0,h.getRawLogHistory)(e,_)}async _addChannel(e){(0,c.assert)(!this.hasChannel(e),`Channel with name ${e} has already been subscribed`),m.logNormal(`Adding channel ${e}`),this._channels.push(e);const{maxSize:t}=this._settings;return void 0!==t&&this._channels.length>t&&(this._channels=this._channels.slice(this._channels.length-t)),this._transport.setUrl(this._generateUrl())}async _removeChannel(e){const t=this._channels.indexOf(e);return(0,c.assert)(-1!==t,`There is no channel with name ${e}`),m.logNormal(`Removing channel ${e}`),this._channels.splice(t,1),
this._transport.setUrl(this._generateUrl())}_onPushStreamMessage(e){if("string"!=typeof e)throw new Error("Wrong message type, expected string");const t=JSON.parse(e),s=t.id,n=t.channel;-2===s?m.logWarn("Received unexpected message: about removed the channel"):s>0&&(m.logDebug(`Received message: id="${s}" channel="${n}"`),this._messageHandler(t.text,s,n))}_onPushStreamClose(e){1005===e.code&&o.telemetry.sendChartReport("websocket_code_1005")}_generateUrl(){const e=this._channels.join("/");return m.logNormal(`Generate pushstream url - ${e}`),`${this._settings.url}/${this._settings.urlPath}/${e}`}}s(659863);class S{constructor(){this._handlers={},this._specialHandlers={}}on(e,t){const s=this._isSpecialChannel(e)?this._specialHandlers:this._handlers;s[e]||(s[e]=[]),s[e].push(t)}off(e,t){const s=this._isSpecialChannel(e)?this._specialHandlers:this._handlers;if(!(e in s))return;if(void 0===t)return void delete s[e];const n=s[e].indexOf(t);n>=0&&s[e].splice(n,1)}emit(e,t,s,n){this._handlers[s]&&this._handlers[s].forEach((i=>{i(e,t,s,n)}));for(const i of Object.keys(this._specialHandlers)){const r="^"+i.replace(/\*/g,".*?")+"$";new RegExp(r).test(s)&&this._specialHandlers[i].forEach((i=>{i(e,t,s,n)}))}}_isSpecialChannel(e){return/\*/.test(e)}}var v=s(125226),b=s(900608),f=s(314802),w=s(251924),C=s(197188),E=s(23482);function P(){return!E.isIOS&&!E.isIPad&&void 0!==navigator.locks}class T{constructor(){this._id=(0,b.guid)(),this._state={[this._id]:{}},this._xEventPrefix="multiplexer-state-",this._xEventCreateTab=this._xEventPrefix+"create-new-tab",this._xEventShareState=this._xEventPrefix+"share-state",this._lockName="tab_destruction",this._stateChangeDelegate=new w.Delegate,this._createdLocks={},this._lockEnabled=P(),this._lockPromise=(0,C.createDeferredPromise)(),this._lockCreated=(0,C.createDeferredPromise)(),this._onTabCreateCb=null,this._onTabCreate=e=>{this._onTabCreateCb&&this._onTabCreateCb();const t=JSON.parse(e);this._state[t]={},this._shareState(),this._requestTabRemoveLock(t)},this._shareState=async()=>{await this._lockCreated.promise;const e=JSON.stringify([this._id,this._state[this._id]]);n.TVXWindowEvents.emit(this._xEventShareState,e)},this._requestTabRemoveLock=e=>{!this._createdLocks[e]&&this._lockEnabled&&(this._createdLocks[e]=1,navigator.locks.request(`${this._lockName}_${e}`,(async()=>{const t=this._state[e]||{};this._compareTabState(e,{},t,"add"),this._compareTabState(e,t,{},"remove"),delete this._state[e],delete this._createdLocks[e]})))},this._onShareStateFromOther=e=>{const[t,s]=JSON.parse(e),n=this._state[t]||{};this._compareTabState(t,s,n,"add"),this._compareTabState(t,n,s,"remove"),this._state[t]=s,this._requestTabRemoveLock(t)},this._removeChannel=(e,t)=>{delete this._state[this._id][e][t],this._isListenByAnotherTab(e,t)||this._stateChangeDelegate.fire("remove",e,t);0===Object.keys(this._state[this._id][e]).length&&delete this._state[this._id][e]},n.TVXWindowEvents.on(this._xEventCreateTab,this._onTabCreate),n.TVXWindowEvents.on(this._xEventShareState,this._onShareStateFromOther),
this._lockEnabled?navigator.locks.request(`${this._lockName}_${this._id}`,(async()=>(n.TVXWindowEvents.emit(this._xEventCreateTab,JSON.stringify(this._id)),window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockCreated.resolve(),this._lockPromise.promise))):this._lockCreated.resolve()}addChannel(e,t){this._isNotEmpty(e,t)?this._state[this._id][e][t]++:(this._state[this._id][e]||(this._state[this._id][e]={}),this._state[this._id][e][t]=1),this._isListenByAnotherTab(e,t)||this._stateChangeDelegate.fire("add",e,t),this._shareState()}removeChannel(e,t){this._isExist(e,t)&&(this._state[this._id][e][t]--,this._isNotEmpty(e,t)||this._removeChannel(e,t),this._shareState())}collectPushStreamChannels(e){const t=new Set;return Object.keys(this._state).forEach((s=>{const n=this._state[s][e];this._state[s][e]&&Object.keys(n).forEach((e=>t.add(e)))})),Array.from(t)}onStateChange(e){this._stateChangeDelegate.subscribe(null,e)}offStateChange(e){this._stateChangeDelegate.unsubscribe(null,e)}onTabCreate(e){this._onTabCreateCb=e}_isExist(e,t,s=this._id){return void 0!==this._state[s]&&void 0!==this._state[s][e]&&void 0!==this._state[s][e][t]}_isNotEmpty(e,t,s=this._id){return this._isExist(e,t,s)&&this._state[s][e][t]>0}_compareTabState(e,t,s,n){Object.keys(t).forEach((i=>{Object.keys(t[i]).forEach((t=>{this._isListenByAnotherTab(i,t,e)||s[i]&&s[i][t]||this._stateChangeDelegate.fire(n,i,t)}))}))}_isListenByAnotherTab(e,t,s=this._id){return Object.keys(this._state).some((n=>n!==s&&this._isNotEmpty(e,t,n)))}}const y=(0,h.getLogger)(_),k={url:window.PUSHSTREAM_URL,urlPath:"message-pipe-ws",transportType:p.WebSocket},R={url:window.PUSHSTREAM_URL.replace("wss://","https://"),urlPath:"message-pipe-es",transportType:p.EventSource};class O{constructor(){var e;this.guid=(0,b.guid)(),this._pushStreamPublic=null,this._pushStreamPrivate=null,this._statusHandlers=[],this._reconnectHandlers=[],this._userPrivateChannel=null,this._channelMultiplexer=new S,this._xEventPrefix="multiplexer-bc-",this._storagePrefix="pushStreamMultiplexerState.",this._userChannelPrefix="private_",this._statusPublic=a.ConnectionStatus.Closed,this._statusPrivate=a.ConnectionStatus.Closed,this._xEventSend=this._xEventPrefix+"send",this._xEventConnectionStatus=this._xEventPrefix+"connectionStatus",this._xEventReconnectCommand=this._xEventPrefix+"reconnectCommand",this._xEventReconnectSuccess=this._xEventPrefix+"reconnectSuccess",this._xEventRequestLogs=this._xEventPrefix+"requestLogs",this._xEventShareLogs=this._xEventPrefix+"shareLogs",this._state=new T,this._shareLogsKey=this._storagePrefix+"shareLogs",this._lockName="pushstream",this._lockPromise=(0,C.createDeferredPromise)(),this._dispatchReconnectSuccessCommandFromOther=e=>{if(this.ownPushStream())return;const[t]=this._decodeParams(e);this._callReconnectHandlers(t)},this._dispatchMessage=(e,t,s)=>{this._dispatchMessageToOthers(e,t,s),this._dispatchMessageToSelf(e,t,s,!1)},this._dispatchMessageFromOther=e=>{if(this.ownPushStream())return;const[t,s,n]=this._decodeParams(e)
;this._dispatchMessageToSelf(t,s,n,!0)},this._dispatchStatusChangeFromOther=e=>{const t=this._decodeConnectionStatus(e),s=t[0],n=t[1];this.ownPushStream()||this._dispatchStatusChangeToSelf(s,n)},this._dispatchReconnectCommandFromOther=()=>{this.ownPushStream()&&this.forceConnect()},this._onRequestLogs=()=>{if(this.ownPushStream()){const e=this._getOwnLogs();let t="";try{t=JSON.stringify(e)}catch(e){y.logError("Failed to stringify own pushstream logs")}r.TVLocalStorage.setItem(this._shareLogsKey,t),n.TVXWindowEvents.emit(this._xEventShareLogs,t)}},this._onStateChange=(e,t,s)=>{const n="private"===t?this._pushStreamPrivate:this._pushStreamPublic;"add"===e?n?.addChannel(s):n?.removeChannel(s)},this._onNewTabCreate=()=>{this._dispatchStatusChangeToOthers(this._statusPublic,this._statusPrivate)},P()?navigator.locks.request(this._lockName,(async()=>(this._state.onStateChange(this._onStateChange),this._state.onTabCreate(this._onNewTabCreate),this._instantiatePushStream(),window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockPromise.promise))):(this._state.onStateChange(this._onStateChange),this._instantiatePushStream()),n.TVXWindowEvents.on(this._xEventSend,this._dispatchMessageFromOther),n.TVXWindowEvents.on(this._xEventConnectionStatus,this._dispatchStatusChangeFromOther),n.TVXWindowEvents.on(this._xEventReconnectCommand,this._dispatchReconnectCommandFromOther),n.TVXWindowEvents.on(this._xEventReconnectSuccess,this._dispatchReconnectSuccessCommandFromOther),n.TVXWindowEvents.on(this._xEventRequestLogs,this._onRequestLogs),e=()=>{window.loginStateChange&&window.loginStateChange.subscribe(this,this._changeLoginState)},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}on(e,t){this._channelMultiplexer.on(e,t)}off(e,t){this._channelMultiplexer.off(e,t)}onStatus(e){this._statusHandlers.push({handler:e,isPrivate:!1}),setTimeout((()=>e(this._statusPublic)),0)}onPrivateStatus(e){this._statusHandlers.push({handler:e,isPrivate:!0}),setTimeout((()=>e(this._statusPrivate)),0)}onReconnect(e,t=!1){this._reconnectHandlers.push({handler:e,isPrivate:t})}offReconnect(e){this._reconnectHandlers=this._reconnectHandlers.filter((t=>t.handler!==e))}offStatus(e){this._statusHandlers=this._statusHandlers.filter((t=>t.handler!==e))}forceConnect(){y.logNormal(`Creating pushstream connection after force connect. Main tab: ${this.ownPushStream()}`),this.ownPushStream()?(this._pushStreamPublic?.disconnect(),this._pushStreamPrivate?.disconnect(),this._instantiatePushStream()):n.TVXWindowEvents.emit(this._xEventReconnectCommand)}disconnect(){this.ownPushStream()&&this._destructPushStream()}getLogs(e){return new Promise((t=>{const s=setTimeout((()=>{const e=r.TVLocalStorage.getItem(this._shareLogsKey);t(null!==e?JSON.parse(e):[])}),1e3),i=e=>{let r;n.TVXWindowEvents.off(this._xEventShareLogs,i),n.TVXWindowEvents.emit(this._xEventShareLogs,""),clearTimeout(s);try{r=JSON.parse(e)}catch(e){r=[],y.logError("Failed to parse logs received from master tab")}t(r)}
;this.ownPushStream()?t(this._getOwnLogs(e)):(n.TVXWindowEvents.on(this._xEventShareLogs,i),n.TVXWindowEvents.emit(this._xEventRequestLogs))}))}ownPushStream(){return!!this._pushStreamPublic||!!this._pushStreamPrivate}pushStream(){if(!this.ownPushStream())throw new Error("Not own PushStream");return this._pushStreamPublic}isConnected(){return this._statusPublic>0}status(){return this._statusPublic??a.ConnectionStatus.Closed}statusPrivate(){return this._statusPrivate??a.ConnectionStatus.Closed}userChannel(){if(!this._userPrivateChannel)throw new Error("No user channel");return this._userChannel(this._userPrivateChannel)}addChannel(e){this._state.addChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}removeChannel(e){this._state.removeChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}static getInstance(){return null===this._instance&&(this._instance=new O),this._instance}_userChannel(e){return this._userChannelPrefix+e}_codeParams(e){const t=[...e];return t.push((new Date).getTime()),JSON.stringify(t)}_decodeParams(e){const t=JSON.parse(e);return t.pop(),t}_instantiatePushStream(){this._pushStreamPublic&&((0,i.trackEvent)("PushstreamDoublePublic",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPublic.disconnect());const e=this._getPushStreamSettings();this._pushStreamPublic=new g(this._dispatchMessage,e),this._pushStreamPublic.connectionStatus().subscribe((e=>{this._dispatchStatusChange(e,this._statusPrivate)})),this._pushStreamPublic.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand()})),this._pushStreamPrivate&&((0,i.trackEvent)("PushstreamDoublePrivate",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPrivate.disconnect()),this._pushStreamPrivate=new g(this._dispatchMessage,{...e,maxSize:1}),this._pushStreamPrivate.connectionStatus().subscribe((e=>{this._dispatchStatusChange(this._statusPublic,e)})),this._pushStreamPrivate.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand(!0)})),this.on("pushstream_set_user_channel",(e=>{this._setUserChannel(e)})),this._connectChannels()}_destructPushStream(){const e=this._pushStreamPublic;this._pushStreamPublic=null,e?.disconnect();const t=this._pushStreamPrivate;this._pushStreamPrivate=null,t?.disconnect(),this._dispatchStatusChangeFromOther(this._codeParams([a.ConnectionStatus.Closed,a.ConnectionStatus.Closed]))}_connectChannels(){this._pushStreamPublic?.addChannel("public");const e=this._state.collectPushStreamChannels("public");void 0!==e&&e.length>0&&e.map((e=>this._pushStreamPublic?.addChannel(e))),"is_authenticated"in window?this._connectUserChannelInitial(!0):window.loginStateChange&&window.loginStateChange.subscribe(this,this._connectUserChannelInitial),this._isPublicPushstreamEnabled()&&this._pushStreamPublic?.connect()}_getPushStreamSettings(){return(0,f.isOnMobileAppPage)("any")?(0,v.isFeatureEnabled)("enable_eventsource_pushstream_mobile")?R:k:(0,v.isFeatureEnabled)("enable_eventsource_pushstream_transport")?R:k}
_isPublicPushstreamEnabled(){return(0,f.isOnMobileAppPage)("any")||!(0,v.isFeatureEnabled)("disable_pushstream_connections_for_anonymous_users")||window.is_authenticated||window.TradingView?.onChartPage}_connectUserChannelInitial(e){e&&(window.is_authenticated?(this._userPrivateChannel=window.user.private_channel??null,this._pushStreamPrivate?.addChannel(this.userChannel()),this._pushStreamPrivate?.connect()):this._userPrivateChannel=null)}_changeLoginState(e){e||(this._isPublicPushstreamEnabled()&&this._pushStreamPublic?.connect(),window.is_authenticated?(this._userPrivateChannel=window.user.private_channel??null,this.ownPushStream()&&(this._pushStreamPrivate?.addChannel(this.userChannel()),this._pushStreamPrivate?.connect())):(this.ownPushStream()&&(this._pushStreamPrivate?.removeChannel(this.userChannel()),this._pushStreamPrivate?.disconnect()),this._userPrivateChannel=null))}_setUserChannel(e){y.logNormal("Set user channel "+e),e!==this._userPrivateChannel&&(this.ownPushStream()&&this._userPrivateChannel&&this._pushStreamPrivate?.removeChannel(this.userChannel()),this._userPrivateChannel=e,this.ownPushStream()&&this._userPrivateChannel&&this._pushStreamPrivate?.addChannel(this.userChannel()))}_dispatchStatusChange(e,t){this._dispatchStatusChangeToOthers(e,t),this._dispatchStatusChangeToSelf(e,t)}_dispatchStatusChangeToSelf(e,t){e!==this._statusPublic&&(this._statusPublic=e,this._callStatusHandlers(e,!1)),t!==this._statusPrivate&&(this._statusPrivate=t,this._callStatusHandlers(t,!0))}_callStatusHandlers(e,t){y.logNormal("Connection status change: "+e+", private "+t+", is main tab "+this.ownPushStream()),o.telemetry.sendReport("site","pushstream_status_change"),this._statusHandlers.forEach((s=>{s.isPrivate===t&&s.handler(e)}))}_callReconnectHandlers(e){y.logNormal("Reconnection has been made"),this._reconnectHandlers.forEach((t=>{t.isPrivate===e&&t.handler()}))}_dispatchReconnectSuccessCommand(e=!1){if(this.ownPushStream()){this._callReconnectHandlers(e);const t=this._codeParams([e]);n.TVXWindowEvents.emit(this._xEventReconnectSuccess,t)}}_decodeConnectionStatus(e){const t=parseInt(e,10);return isNaN(t)?this._decodeParams(e):[t,t]}_dispatchStatusChangeToOthers(e,t){if(this.ownPushStream()){const s=this._codeParams([e,t]);n.TVXWindowEvents.emit(this._xEventConnectionStatus,s)}}_dispatchMessageToSelf(e,t,s,n){const i=e.channel,r=e.content;this._emit(r,t,i,n)}_dispatchMessageToOthers(e,t,s){const i=[e,t,s];n.TVXWindowEvents.emit(this._xEventSend,this._codeParams(i))}_emit(e,t,s,n){this._channelMultiplexer.emit(e,t,s,n)}_getOwnLogs(e){if(this.ownPushStream()){const t=(0,h.getRawLogHistory)(e,_),s=this.pushStream()?.getLogs();return[].concat(t,s??[])}return[]}}O._instance=null;const L=O.getInstance()},564894:(e,t,s)=>{s.d(t,{hasService:()=>h,registerService:()=>a,service:()=>c,unregisterService:()=>o,waitServiceRegistered:()=>l});var n=s(197188);const i={},r=new Map;function a(e,t){if(h(e))throw new Error("Service already registered");i[e.id]=t;const s=r.get(e.id);void 0!==s&&(r.delete(e.id),s.resolve(t))}function o(e){
if(!h(e))throw new Error("Service not found");i[e.id]=void 0}function h(e){return void 0!==i[e.id]}function c(e){const t=i[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function l(e){if(h(e))return Promise.resolve(c(e));let t=r.get(e.id);return void 0===t&&(t=(0,n.createDeferredPromise)(),r.set(e.id,t)),t.promise}},354298:(e,t,s)=>{s.d(t,{reconnectChartApi:()=>n,setBroker:()=>i});s(122023);function n(e){const t=window.ChartApiInstance;window.is_authenticated&&(t.disconnect(),e&&t.authTokenManager().reset(),setTimeout((()=>t.connect()),500))}function i(e){window.ChartApiInstance.setBroker(e)}},483102:(e,t,s)=>{function n(e){const t=Object.create(e);return t.release=()=>{},t.ownership=()=>t,t}function i(e){const t=e;return t.release=()=>t.destroy(),t.ownership=()=>t,t}s.d(t,{ownership:()=>i,weakReference:()=>n})},666310:(e,t,s)=>{s.d(t,{Interval:()=>n.Interval,ResolutionKind:()=>n.ResolutionKind,SpecialResolutionKind:()=>n.SpecialResolutionKind,isHour:()=>n.isHour});var n=s(257253)},673378:(e,t,s)=>{s.d(t,{createPrimitiveProperty:()=>i});var n=s(751610);function i(e){return new n.Property(e)}},57408:(e,t,s)=>{s.d(t,{PropertyBase:()=>r});var n=s(650151),i=s(251924);class r{constructor(){this._listeners=new i.Delegate,this._muteChildChanges=!1,this._owner=null,this._name=""}nameInOwner(){return this._name}setNameInOwner(e){this._name=e}owner(){return this._owner}setOwner(e){this._owner=e}pathToRoot(){const e=this._owner?.pathToRoot();return e?`${e}.${this._name}`:this._name}pathToRootProperty(){if(!this._owner)return"";const e=this._owner.pathToRootProperty?.();return e?`${e}.${this._name}`:this._name}removeProperty(e){(0,n.assert)(!1,`Trying to call "removeProperty" on property ${this.pathToRoot()}`)}addChild(e,t){(0,n.assert)(!1,`Trying to call "addChild" on property ${this.pathToRoot()}`)}hasChild(e){return!1}childCount(){return 0}childNames(){return[]}childs(){(0,n.assert)(!1,`Trying to call "childs" on property ${this.pathToRoot()}`)}state(e,t){return this.value()}merge(e,t){(0,n.assert)(!1,`Trying to call "merge" on property ${this.pathToRoot()}`)}mergeAndFire(e){(0,n.assert)(!1,`Trying to call "mergeAndFire" on property ${this.pathToRoot()}`)}child(e){if(this.hasChild(e))return this.childs()[e]}muteChildChanges(e){this._muteChildChanges=e}fireChanged(){this._listeners.fire(this,this.pathToRootProperty())}listeners(){return this._listeners}subscribe(e,t){this.listeners().subscribe(e,t,!1)}unsubscribe(e,t){this.listeners().unsubscribe(e,t)}unsubscribeAll(e){this.listeners().unsubscribeAll(e)}}},113640:(e,t,s)=>{s.d(t,{DataTypes:()=>n,createPropertySchema:()=>p,dataType:()=>u,extractStateWithSchema:()=>g,isArraySchema:()=>m,validateSchema:()=>_});var n,i=s(569708),r=s(283873),a=s(683350),o=s(456052),h=s(182433),c=s(936714),l=s(650151);function u(e){return(0,i.default)(e)?n.NUMBER:(0,r.default)(e)?n.STRING:(0,a.default)(e)?n.BOOLEAN:(0,o.default)(e)?n.ARRAY:null===e?n.NULL:"object"==typeof e?n.OBJECT:n.UNKNOWN}!function(e){e.STRING="string",e.NUMBER="number",
e.BOOLEAN="boolean",e.OBJECT="object",e.ARRAY="array",e.NULL="null",e.UNKNOWN="unknown"}(n||(n={}));const d=[n.ARRAY,n.OBJECT];function _(e,t){try{const s=u(e);if((0,l.assert)(s===t.type||s===n.NULL&&t.nullable||t.type===n.UNKNOWN),d.includes(s))switch(t.type){case n.ARRAY:(0,l.assert)(e.every((e=>_(e,t.subschema))));break;case n.OBJECT:for(const[s,n]of Object.entries(t.subschema))(0,l.assert)(_(e[s],n))}return!0}catch{return!1}}function m(e){return e.type===n.ARRAY}function p(e,t){let s;const i=u(e);switch(i){case n.NUMBER:case n.STRING:case n.BOOLEAN:s={type:i,saveFlags:t};break;case n.ARRAY:s={type:n.ARRAY,saveFlags:t,subschema:p(e[0],t)};break;case n.OBJECT:{const i={};for(const[s,n]of Object.entries(e))i[s]=p(n,t);s={type:n.OBJECT,saveFlags:t,subschema:i};break}default:s={type:n.UNKNOWN,saveFlags:t}}return s}function g(e,t,s){if(!function(e){return e.type===n.OBJECT}(t)||!(0,h.default)(e))return e;const i=Object.keys(e);for(const n of i){const i=t.subschema[n];void 0===t.saveFlags||i||(0,c.default)(e,n);const r=i?.saveFlags;void 0===r||r&s||(0,c.default)(e,n),i&&g(e[n],i,s)}return e}},751610:(e,t,s)=>{s.d(t,{Property:()=>p,isPrimitiveType:()=>m});var n=s(569708),i=s(283873),r=s(683350),a=s(688987),o=s(456052),h=s(650151),c=s(735566),l=s(483102),u=s(57408),d=s(113640);const _=(0,c.getLogger)("Property");function m(e){return null===e||(0,n.default)(e)&&Number.isFinite(e)||(0,i.default)(e)||(0,r.default)(e)}class p extends u.PropertyBase{constructor(e,t){if(super(),this._childs=[],this._dependents=[],this._schema=t||(0,d.createPropertySchema)(e),void 0!==e)if((0,d.validateSchema)(e,this._schema)||_.logWarn(`The state with a data type: ${(0,d.dataType)(e)} does not match a schema`),m(e))this._value=e;else{let t=Object.entries(e);(0,d.isArraySchema)(this._schema)&&(t=t.filter((([e])=>!Number.isNaN(+e))));for(const[e,s]of t)this.addProperty(e,s)}}destroy(){this.listeners().destroy();for(const e of this._childs)this.child(e)?.destroy?.()}merge(e,t){let s=null,n=0;if(t&&(s=[],n=s.length),void 0===e)return s;if(m(e))return this._value!==e&&s?.push(this),this._value=e,s;if((0,o.default)(e)){(0,d.isArraySchema)(this._schema)||_.logWarn("Property is not an array");for(let n=0;n<e.length;n++){const i=this.childs()[n];if(i){const r=i.merge(e[n],t);s?.push(...r)}else{const t=this.addProperty(`${n}`,e[n]);s?.push(t)}}}else{let n=Object.entries(e);(0,d.isArraySchema)(this._schema)&&(n=n.filter((([e])=>!Number.isNaN(+e))));for(const[e,i]of n){const n=this.childs()[e];if(n){const e=n.merge(i,t);s?.push(...e)}else{const t=this.addProperty(e,i);s?.push(t)}}}return s&&s.length>n&&s.push(this),s}mergeAndFire(e){const t=(0,h.ensureNotNull)(this.merge(e,!0));this._fireMergeAndFireChangedProps(t)}state(e,t){const s=(0,a.default)(this.value)?this.value():void 0;if(void 0!==s)return s;const n=(0,d.isArraySchema)(this._schema)?[]:{};for(const s of this._childs){if(e&&-1!==e.indexOf(s))continue;if((0,d.isArraySchema)(this._schema)&&Number.isNaN(+s))continue;if(void 0!==t&&"subschema"in this._schema){const e=(0,
d.isArraySchema)(this._schema)?this._schema.subschema:this._schema.subschema[s];if(void 0!==this._schema.saveFlags&&!e)continue;if(void 0!==e?.saveFlags&&!(e.saveFlags&t))continue}const i=this.childs()[s];let r;if(e){const n=[];for(const t of e)t.startsWith(s+".")&&n.push(t.substring(s.length+1));r=i?.state(n,t)}else r=i?.state();(void 0!==r||i?.storeStateIfUndefined())&&((0,o.default)(n)?n[+s]=r:n[s]=r)}return n}clone(){return new p(this.state())}value(){return this._value}childCount(){return this._childs.length}childNames(){return this._childs}childByPath(e){let t=this;for(const s of e.split(".")){if(void 0===t)break;t=t.child(s)}return t}hasChild(e){return this._childs.includes(e)}setValue(e,t){(this._value!==e||t)&&(this._value=e,this.fireChanged())}setValueSilently(e){this._value=e}addProperty(e,t){let s;(0,d.isArraySchema)(this._schema)&&Number.isNaN(+e)&&_.logWarn("Property is an array"),this.removeProperty(e),this._schema.type===d.DataTypes.OBJECT?s=this._schema.subschema[e]:this._schema.type===d.DataTypes.ARRAY&&(s=this._schema.subschema);const n=new p(t,s);return this[e]=n,this._childs.push(e),n.subscribe(this,((e,t)=>{this._childChanged(e,t)})),n.setOwner(this),n.setNameInOwner(e),n}removeProperty(e){const t=this.child(e);t&&(t.setNameInOwner(""),t.setOwner(null),t.unsubscribeAll(this),delete this[e],this._childs=this._childs.filter((t=>t!==e)))}addChild(e,t){if((0,d.isArraySchema)(this._schema)&&Number.isNaN(+e))throw new Error("Property is an array");this[e]&&this.removeProperty(e),this[e]=t,-1===this._childs.indexOf(e)&&this._childs.push(e),t.subscribe(this,((e,t)=>this._childChanged(e,t))),t.setOwner(this),t.setNameInOwner(e)}childs(){return this}storeStateIfUndefined(){return!0}ownership(){return(0,l.ownership)(this)}weakReference(){return(0,l.weakReference)(this)}addDependent(e){this._dependents.push(e)}removeDependent(e){const t=this._dependents.indexOf(e);t>=0&&this._dependents.splice(t,1)}dependents(){return this._dependents}_childChanged(e,t){this._muteChildChanges||this._listeners.fire(this,t)}_fireMergeAndFireChangedProps(e){this.muteChildChanges(!0);for(const t of e)t.muteChildChanges(!0);for(const t of e)t.muteChildChanges(!1),t.fireChanged();this.muteChildChanges(!1)}}},503447:(e,t,s)=>{s.r(t),s.d(t,{SERIES_STATUS_TEXT:()=>E,STATUS_CALCULATION_ERROR:()=>b,STATUS_DELAYED:()=>m,STATUS_DELAYED_STREAMING:()=>p,STATUS_EOD:()=>d,STATUS_ERROR:()=>v,STATUS_INVALID_SYMBOL:()=>l,STATUS_LOADING:()=>h,STATUS_NO_BARS:()=>g,STATUS_OFFLINE:()=>a,STATUS_PULSE:()=>_,STATUS_READY:()=>c,STATUS_REPLAY:()=>S,STATUS_RESOLVING:()=>o,STATUS_SNAPSHOT:()=>u,STATUS_UNSUPPORTED_RESOLUTION:()=>f,STYLE_AREA:()=>k,STYLE_BARS:()=>P,STYLE_BASELINE:()=>W,STYLE_CANDLES:()=>T,STYLE_COLUMNS:()=>M,STYLE_HEIKEN_ASHI:()=>A,STYLE_HILO:()=>I,STYLE_HLC_AREA:()=>U,STYLE_HLC_BARS:()=>B,STYLE_HOLLOW_CANDLES:()=>x,STYLE_KAGI:()=>O,STYLE_LINE:()=>y,STYLE_LINE_WITH_MARKERS:()=>V,STYLE_PB:()=>N,STYLE_PNF:()=>L,STYLE_RANGE:()=>H,STYLE_RENKO:()=>R,STYLE_SHORT_NAMES:()=>F,STYLE_STEPLINE:()=>D,SYMBOL_STRING_DATA:()=>q,
chartStylesWithAttachedStudies:()=>K,isChartStyleStudyInfoComplex:()=>$,seriesLoadingStatuses:()=>C,seriesReadyStatuses:()=>w});var n=s(175468),i=s(735685),r=s(353887);const a=0,o=1,h=2,c=3,l=4,u=5,d=6,_=7,m=8,p=9,g=10,S=11,v=12,b=13,f=14,w=new Set([3,6,7,8,9,11]),C=new Set([1,2]),E={[a]:"connecting",[o]:"loading",[h]:"loading",[c]:"realtime",[l]:"invalid",[u]:"snapshot",[d]:"endofday",[_]:"endofday",[m]:"delayed",[p]:"delayed_streaming",[g]:"forbidden",[S]:"replay",[v]:"error",[b]:"calculation_error",[f]:"unsupported_resolution"},P=0,T=1,y=2,k=3,R=4,O=5,L=6,N=7,A=8,x=9,W=10,H=11,I=12,M=13,V=14,D=15,U=16,B=21,F={0:"bar",1:"candle",9:"hollowCandle",2:"line",14:"lineWithMarkers",15:"stepline",3:"area",16:"hlcArea",4:"renko",7:"pb",5:"kagi",6:"pnf",8:"ha",10:"baseline",11:"range",12:"hilo",13:"column",17:"volFootprint",18:"tpo",19:"volCandles",20:"svp",21:"hlcBars"};function $(e){return"variants"in e}const Y=[{type:i.studyTpoPreriodicId,basicStudyVersion:104},{type:i.studyTpoSessionsId,basicStudyVersion:104}],q={4:{type:"BarSetRenko@tv-prostudies",basicStudyVersion:73},7:{type:"BarSetPriceBreak@tv-prostudies",basicStudyVersion:34},5:{type:"BarSetKagi@tv-prostudies",basicStudyVersion:73},6:{type:"BarSetPnF@tv-prostudies",basicStudyVersion:73},8:{type:"BarSetHeikenAshi@tv-basicstudies",basicStudyVersion:60},11:{type:"BarSetRange@tv-basicstudies",basicStudyVersion:72},17:{type:n.studyVolFootprintId,basicStudyVersion:104},18:{variants:Y,selector:e=>{const t=e;return"Day"===t.period&&1===t.periodsNum?Y[1]:Y[0]}},20:{type:r.studyVbPSessionsId,basicStudyVersion:126}},K=[17,18,20]},735685:(e,t,s)=>{s.d(t,{studyTpoPreriodicId:()=>n,studyTpoSessionsId:()=>i});const n="TPOPeriodic@tv-volumebyprice",i="TPOSessions@tv-volumebyprice"},175468:(e,t,s)=>{s.d(t,{studyVolFootprintId:()=>n});const n="Footprint@tv-volumebyprice"},353887:(e,t,s)=>{s.d(t,{studyVbPSessionsId:()=>n});const n="VbPSessions@tv-volumebyprice"},666054:(e,t,s)=>{var n;s.d(t,{ConnectionStatus:()=>n}),function(e){e[e.Closed=0]="Closed",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open"}(n||(n={}))},798266:(e,t,s)=>{s.d(t,{PersistentEventSourceTransport:()=>o});var n=s(735566),i=s(666054),r=s(840940);const a=(0,n.getLogger)("PersistentWebsocketTransport");class o extends r.PersistentTransport{constructor(e){super(e,a),this._specializedErrorHandlerBound=this._specializedErrorHandler.bind(this)}_createNativeTransport(e){const t=new EventSource(e,{withCredentials:!0});return t.addEventListener("error",this._specializedErrorHandlerBound),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._specializedErrorHandlerBound),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(i.ConnectionStatus.Closed),
e.readyState!==WebSocket.CLOSED&&e.close()}_specializedErrorHandler(e){e.eventPhase===EventSource.CLOSED?this._socketCloseHandler(e):this._socketErrorHandler()}}},840940:(e,t,s)=>{s.d(t,{PersistentTransport:()=>h});var n=s(666054),i=s(137068),r=s(77294),a=s(251924),o=s(357517);class h{constructor(e,t,s){this._url="",this._socket=null,this._reconnectCount=0,this._onlineCancellationToken=null,this._connectionStatus=new r.WatchedValue(n.ConnectionStatus.Closed),this._socketCloseHandler=this._onCloseCallback.bind(this),this._socketErrorHandler=this._onErrorCallback.bind(this),this._socketOpenHandler=this._onOpenCallback.bind(this),this._socketMessageHandler=this._onMessageCallback.bind(this),this._maxReconnectReachedEventDelegate=new a.Delegate,this._successReconnectReachedEventDelegate=new a.Delegate,this._shouldReconnect=!0,this._maxReconnectCount=null,this._reconnectTimeoutId=0,this._connectAbortController=null,this._tryReconnect=()=>{if(this._disconnect(),this._shouldReconnect){const e=this._getReconnectTimeout();this._logger.logNormal(`Sleeping some time before reconnect ${e}ms`),this._reconnectTimeoutId=setTimeout(this._tryReconnectImpl.bind(this),e)}else this._logger.logNormal("Skip reconnecting because of shouldReconnect state")},this._onOfflineHandler=()=>{this._removeOnOfflineListener(),this._logger.logInfo("Network status changed to offline - trying to reconnect"),this._tryReconnect()},this._logger=t,this._messageHandler=e,this._closeHandler=s,window.addEventListener("unload",(()=>{t.logNormal("Unload event comes - disconnecting without reconnect after that..."),this._shouldReconnect=!1,this._disconnect()}),!1)}setUrl(e){if(this._url===e)return Promise.resolve();const t=this._connectionStatus.value()!==n.ConnectionStatus.Closed;return t&&this._disconnect(),this._url=e,t?this.connect():Promise.resolve()}url(){return this._url}connect(){return this._connectImpl()}setMaxReconnectCount(e){this._maxReconnectCount=e}connectionStatus(){return this._connectionStatus.readonly()}disconnect(){this._shouldReconnect=!1,this._disconnect()}maxReconnectReachedEvent(){return this._maxReconnectReachedEventDelegate}successReconnectReachedEvent(){return this._successReconnectReachedEventDelegate}async _prepareParamsForConnection(e){}_disconnect(){this._connectAbortController?.abort(),this._connectAbortController=null,clearTimeout(this._reconnectTimeoutId),this._reconnectTimeoutId=0,this._connectionStatus.value()!==n.ConnectionStatus.Closed?this._socket?(this._logger.logNormal(`Closing connection to: ${this._socket.url}, currentStatus: ${n.ConnectionStatus[this._connectionStatus.value()]}`),this._disconnectTransport()):this._logger.logNormal("Disconnecting without socket - probably within preparing, it should be already scheduled for aborting"):this._logger.logNormal("Attempt to close connection but it is closed already")}_onErrorCallback(){this._logger.logInfo("Connection is closed by error"),this._tryReconnect()}_onCloseCallback(e){this._logger.logInfo(`Connection is closed - code=${e.code} msg=${e.reason}`),
this._closeHandler?.(e),this._tryReconnect()}_tryReconnectImpl(){return null!==this._maxReconnectCount&&this._reconnectCount===this._maxReconnectCount?(this._logger.logWarn("Maximum attempts to reconnect to websocket reached"),void this._maxReconnectReachedEventDelegate.fire()):(this._reconnectCount+=1,this._logger.logInfo(`Reconnecting count: ${this._reconnectCount}`),navigator.onLine?(this._logger.logInfo("Network status: online - trying to connect"),void this.connect()):(this._logger.logInfo("Network status: offline - wait until online"),void(this._onlineCancellationToken=(0,i.callWhenOnline)((()=>{this._logger.logInfo("Network status changed to online - trying to connect"),this.connect()})))))}_onOpenCallback(){this._logger.logNormal("Connection opened"),this._reconnectCount>0&&this._successReconnectReachedEventDelegate.fire(),this._reconnectCount=0,this._connectionStatus.setValue(n.ConnectionStatus.Open)}_onMessageCallback(e){this._messageHandler(e.data)}_getReconnectTimeout(){return this._reconnectCount<5?300:5e3}_setOnOfflineListener(){window.addEventListener("offline",this._onOfflineHandler)}_removeOnOfflineListener(){window.removeEventListener("offline",this._onOfflineHandler)}async _connectImpl(){if(this._connectionStatus.value()!==n.ConnectionStatus.Closed)return void this._logger.logNormal("Attempt to open connection but it is not closed");this._socket&&(this._logger.logError("Something went wrong - code 0x2"),this.disconnect()),this._onlineCancellationToken&&(this._onlineCancellationToken(),this._onlineCancellationToken=null),this._logger.logNormal(`Connecting to ${this._url}`),this._shouldReconnect=!0,this._connectAbortController=new AbortController;const e=this._connectAbortController.signal;try{if(this._connectionStatus.setValue(n.ConnectionStatus.Connecting),await this._prepareParamsForConnection(e),e.aborted)throw(0,o.createAbortError)();this._socket=this._createNativeTransport(this._url),this._setOnOfflineListener()}catch(e){this._connectionStatus.setValue(n.ConnectionStatus.Closed),(0,o.skipAbortError)(e)}finally{this._connectAbortController=null}}}},420021:(e,t,s)=>{s.d(t,{PersistentWebsocketTransport:()=>o});var n=s(735566),i=s(666054),r=s(840940);const a=(0,n.getLogger)("PersistentWebsocketTransport");class o extends r.PersistentTransport{constructor(e,t){super(e,a,t)}sendMessage(e){this._connectionStatus.value()===i.ConnectionStatus.Open?this._socket?this._socket.send(e):a.logError("Something went wrong - code 0x3"):a.logWarn("Attempt to send message but connection is not opened")}_createNativeTransport(e){const t=new WebSocket(e);return t.binaryType="arraybuffer",t.addEventListener("error",this._socketErrorHandler),t.addEventListener("close",this._socketCloseHandler),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._socketErrorHandler),this._socket.removeEventListener("close",this._socketCloseHandler),
this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(i.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}}},473552:(e,t,s)=>{s.d(t,{UserStatus:()=>n,getDaysUntilBlock:()=>o,getDaysUntilBlockForUser:()=>a,isUserLockedOut:()=>h});var n,i=s(659935),r=s(258208);!function(e){e.NonPro="non_pro",e.Pro="pro"}(n||(n={}));const a=(0,r.memoize)((()=>window.user.is_trial&&window.user.pro_plan?window.user.is_expert||window.user.declared_status!==n.Pro?i.WEEKLY_SUBSCRIPTION_DAYS_LEN:i.MONTHLY_SUBSCRIPTION_DAYS_LEN:i.WEEKLY_SUBSCRIPTION_DAYS_LEN)),o=(0,r.memoize)((()=>{const e=window.user.declared_status_timestamp;if(!e)return null;const t=((new Date).getTime()-new Date(1e3*e).getTime())/1e3/24/60/60;return a()-Math.floor(t)})),h=(0,r.memoize)((e=>{const t=e??o();return Boolean(null!==t&&t<=0)}))},484498:(e,t,s)=>{s.d(t,{getPlatform:()=>r});var n=s(314802),i=s(638456);function r(){return(0,i.isDesktopApp)()?"desktop":(0,n.isOnMobileAppPage)("old")?"ios":(0,n.isOnMobileAppPage)("new")?"android":"web"}},137068:(e,t,s)=>{s.d(t,{callWhenOnline:()=>i,waitForOnline:()=>r});var n=s(357517);function i(e){let t=e;const s=()=>{window.removeEventListener("online",s),t&&t()};return window.addEventListener("online",s),()=>{t=null}}async function r(e=null){return!0===navigator.onLine||void 0===navigator.onLine?Promise.resolve():(0,n.respectAbort)(e,new Promise((e=>{const t=()=>{window.removeEventListener("online",t),e()};window.addEventListener("online",t)})))}},258208:(e,t,s)=>{function n(e,t){const s=new Map;return function(...n){const i=""+(t?t.apply(null,n):n[0]);if(!s.has(i)){const t=e.apply(this,n);return s.set(i,t),t}return s.get(i)}}function i(e){return(t,s,i)=>{const r=i.value,a=Symbol();return{get(){return void 0===this[a]&&(this[a]=n(r,e)),this[a].bind(this)}}}}s.d(t,{memoize:()=>n,memoizeDecorator:()=>i})},257253:(e,t,s)=>{s.d(t,{Interval:()=>l,ResolutionKind:()=>r,SpecialResolutionKind:()=>a,isHour:()=>d});const n=/^(\d*)([TSHDWMR])$/,i=/^(\d+)$/;var r,a;!function(e){e.Ticks="ticks",e.Seconds="seconds",e.Minutes="minutes",e.Days="days",e.Weeks="weeks",e.Months="months",e.Range="range",e.Invalid="invalid"}(r||(r={})),function(e){e.Hours="hours"}(a||(a={}));const o={};o[r.Ticks]=1e3,o[r.Seconds]=1e3,o[r.Minutes]=60*o[r.Seconds],o[r.Days]=1440*o[r.Minutes],o[r.Weeks]=7*o[r.Days];const h={T:r.Ticks,S:r.Seconds,D:r.Days,W:r.Weeks,M:r.Months,R:r.Range},c=new Set([r.Ticks,r.Seconds,r.Minutes]);class l{constructor(e,t){this._kind=r.Invalid,this._multiplier=0,e!==r.Invalid&&t>0&&(this._kind=e,this._multiplier=t)}kind(){return this._kind}guiKind(){return this.isMinuteHours()?a.Hours:this._kind}multiplier(){return this._multiplier}isValid(){return this.kind()!==r.Invalid&&this.multiplier()>0}isDWM(){return this.isValid()&&!this.isRange()&&!this.isIntraday()&&!this.isTicks()}isIntraday(){const e=c.has(this.kind());return this.isValid()&&e}
isSeconds(){return this.kind()===r.Seconds}isMinutes(){return this.kind()===r.Minutes}isMinuteHours(){return this.kind()===r.Minutes&&d(this.multiplier())}isDays(){return this.kind()===r.Days}isWeeks(){return this.kind()===r.Weeks}isMonths(){return this.kind()===r.Months}isRange(){return this.kind()===r.Range}isTicks(){return this.kind()===r.Ticks}is1Tick(){return this.isTicks()&&1===this.multiplier()}isTimeBased(){return!this.isRange()}letter(){return this.isValid()&&this.kind()!==r.Minutes?this.kind()[0].toUpperCase():""}value(){return this.isValid()?this.kind()===r.Minutes?this.multiplier()+"":this.multiplier()+this.letter():""}isEqualTo(e){if(!(e instanceof l))throw new Error("Argument is not an Interval");return!(!this.isValid()||!e.isValid())&&(this.kind()===e.kind()&&this.multiplier()===e.multiplier())}inMilliseconds(e=Date.now()){if(!this.isValid()||this.isRange())return NaN;if(this.isMonths()){const t=new Date(e);t.setUTCMonth(t.getUTCMonth()+(this.multiplier()||1));return+t-e}const t=this.multiplier();return o[this.kind()]*t}static isEqual(e,t){return e===t||l.parse(e).isEqualTo(l.parse(t))}static parseExt(e){e=(e+"").toUpperCase().split(",")[0];let t=n.exec(e);return null!==t?"H"===t[2]?{interval:new l(r.Minutes,60*u(t[1])),guiResolutionKind:a.Hours}:{interval:new l(h[t[2]],u(t[1])),guiResolutionKind:h[t[2]]}:(t=i.exec(e),null!==t?{interval:new l(r.Minutes,u(t[1])),guiResolutionKind:r.Minutes}:{interval:new l(r.Invalid,0),guiResolutionKind:r.Invalid})}static parse(e){return l.parseExt(e).interval}static kind(e){return l.parse(e).kind()}static isValid(e){return l.parse(e).isValid()}static isDWM(e){return l.parse(e).isDWM()}static isIntraday(e){return l.parse(e).isIntraday()}static isSeconds(e){return l.parse(e).isSeconds()}static isMinutes(e){return l.parse(e).isMinutes()}static isMinuteHours(e){return l.parse(e).isMinuteHours()}static isDays(e){return l.parse(e).isDays()}static isWeeks(e){return l.parse(e).isWeeks()}static isMonths(e){return l.parse(e).isMonths()}static isRange(e){return l.parse(e).isRange()}static isTicks(e){return l.parse(e).isTicks()}static isTimeBased(e){return l.parse(e).isTimeBased()}static normalize(e){const t=l.parse(e);return t.isValid()?t.value():null}}function u(e){return 0===e.length?1:parseInt(e,10)}function d(e){return e>=60&&!(e%60)}}}]);