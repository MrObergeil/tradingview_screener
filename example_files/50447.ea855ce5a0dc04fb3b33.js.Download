(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[50447],{843202:e=>{e.exports={actionButton:"actionButton-k53vexPa",small:"small-k53vexPa",hiddenTitle:"hiddenTitle-k53vexPa"}},115937:e=>{e.exports={popupDialog:"popupDialog-B02UUUN3",wrap:"wrap-B02UUUN3",main:"main-B02UUUN3",small:"small-B02UUUN3",title:"title-B02UUUN3",content:"content-B02UUUN3",html:"html-B02UUUN3",footer:"footer-B02UUUN3",close:"close-B02UUUN3",marginWithoutCloseButton:"marginWithoutCloseButton-B02UUUN3"}},825131:(e,t,s)=>{"use strict";s.d(t,{ColorContext:()=>n,ColorManager:()=>l});var n,o=s(989191),i=s(6015),r=s(105205);!function(e){e[e.SymbolMarker=0]="SymbolMarker",e[e.ScreenerFilter=1]="ScreenerFilter"}(n||(n={}));class l{constructor(e){this._context=e.context}getColor(){switch(this._context){case n.SymbolMarker:return this._getAvailableColor(i.SymbolMarkerSettings.getDefaultColor());case n.ScreenerFilter:return this._getAvailableColor(i.SymbolsFilterSettings.getDefaultColor())}}setColor(e){switch(this._context){case n.SymbolMarker:i.SymbolMarkerSettings.setDefaultColor(this._getAvailableColor(e));break;case n.ScreenerFilter:i.SymbolsFilterSettings.setDefaultColor(this._getAvailableColor(e))}}_getAvailableColor(e){return(0,r.checkColorPermissions)(e)?e:(this.setColor(o.ListColor.Red),o.ListColor.Red)}}},105205:(e,t,s)=>{"use strict";s.d(t,{MarkedSymbolsListModel:()=>A,checkColorPermissions:()=>I,getMarkedListsState:()=>B,getSymbolsLimit:()=>P});var n=s(650151),o=s(989191),i=s(50991),r=s(173777);class l{constructor(e){this._executing=null,this._destroyed=!1,this._handleChange=()=>{if(this._destroyed)return;const e=this._getCommands();if(e.length>0){if(null!==this._executing)return;const[t,...s]=e;switch(t.type){case"append":this._executing=this._api.appendSymbols(t.color,t.symbols).then((e=>!e||this._destroyed?null:{[t.color]:{symbols:e}})).then((async e=>{if(this._destroyed)return null;const s=this._selector(this._store.getState()),n=(0,o.getListByColor)(s,t.color);if(null!==n&&null!==n.persistedState&&null!==n.persistedState.id)return e;const i=await this._api.getLists();if(this._destroyed)return null;const r=i.find((e=>e.color===t.color));return r?{[t.color]:{id:r.id,symbols:r.symbols}}:null}));break;case"remove":this._executing=this._api.removeSymbols(t.color,t.symbols).then((e=>!e||this._destroyed?null:{[t.color]:{symbols:e}}));break;case"replace":this._executing=this._api.replaceSymbols(t.color,t.symbols).then((e=>!e||this._destroyed?null:{[t.color]:{symbols:e}}));break;case"reset":this._executing=this._api.resetSymbols(t.symbols).then((()=>{if(this._destroyed)return null;const e={};for(const s of o.LIST_COLORS){const n=t.prevLists.byColor[s];if(!n||!n.persistedState)continue;const o=n.persistedState.symbols.filter((e=>!t.symbols.includes(e)));e[s]={...n.persistedState,symbols:o}}return e}));break;case"rename":this._executing=this._api.renameList(t.color,t.name).then((e=>this._destroyed?null:{[t.color]:e}));break;case"change-description":
this._executing=this._api.changeDescription(t.color,t.description).then((e=>this._destroyed?null:{[t.color]:e}));break;case"reset-all":this._executing=this._api.resetAll().then((()=>{if(this._destroyed)return null;const e={};for(const s of o.LIST_COLORS){const n=t.prevLists.byColor[s];n&&n.persistedState&&(e[s]={...n.persistedState,symbols:[]})}return e}));break;case"share":this._executing=this._api.shareList(t.color,t.shared).then((e=>this._destroyed?null:{[t.color]:{shared:e.shared}}));break;case"rename-separator":this._executing=this._api.renameSeparator(t.color,t.separator,t.name).then((e=>!e||this._destroyed?null:{[t.color]:{symbols:e}}))}this._executing.then((e=>{if(this._executing=null,this._destroyed)return;const[n]=this._getCommands();n===t?(this._store.dispatch((0,o.shiftCommand)({count:1})),e&&this._store.dispatch((0,o.updatePersistedState)(e))):(this._onWarn(`Command: ${JSON.stringify(t)} was sent to the server but is not found in the state`),s.length>0&&this._onWarn(`Commands: ${JSON.stringify(s)} was dropped from state without syncing with server`)),this._handleChange()}),(e=>{if(this._destroyed)return;this._executing=null;const{colors:s,byColor:i}=t.prevLists,r=s.map((e=>(0,n.ensureDefined)(i[e])));this._store.dispatch((0,o.setup)({lists:r,timestamp:(0,n.ensureNotNull)((0,o.getTimestamp)(this._selector(this._store.getState())))})),this._onError(t,e)}))}};const{root:t,selector:s,onError:i,onWarn:r,api:l}=e;this._store=t,this._selector=s,this._subscription=this._store.subscribe(this._handleChange),this._onError=i,this._onWarn=r,this._api=l,this._handleChange()}destroy(){this._subscription(),this._destroyed=!0}_getCommands(){const e=this._selector(this._store.getState());return(0,o.getCommands)(e)}}var a=s(735566),c=s(444372),h=s(954912),u=s(77117),d=s(341286),m=s(421907),_=s(658583);async function y(e,t){const s=(0,u.remoteSymbolsFormLocalState)(e,t);return d.pendingOpenSeparators.delete(e),(0,h.fetch)((0,_.watchlistUrl)(`/api/v1/symbols_list/colored/${e}/replace/?unsafe=true`),{method:"POST",body:JSON.stringify(s),credentials:"include",headers:{"Content-Type":"application/json"}}).then(_.handleJSON)}var S=s(591152);const g=(0,a.getLogger)("MarkedSymbols.Api");class p{getLists(){return(0,h.fetch)((0,_.watchlistUrl)("/api/v1/symbols_list/colored/"),{credentials:"include"}).then(_.handleJSON)}removeSymbols(e,t){return 0===t.length?Promise.resolve(null):(g.logNormal(`Sending request to remove symbols from ${e}-list: ${t}`),async function(e,t){return d.pendingOpenSeparators.has(e)?y(e,(0,u.getLocalListSymbols)(e)):(0,h.fetch)((0,_.watchlistUrl)(`/api/v1/symbols_list/colored/${e}/remove/`),{method:"POST",body:JSON.stringify(t),credentials:"include",headers:{"Content-Type":"application/json"}}).then(_.handleJSON)}(e,t))}appendSymbols(e,t){return 0===t.length?Promise.resolve(null):(g.logNormal(`Sending request to append symbols to ${e}-list: ${t}`),async function(e,t){return d.pendingOpenSeparators.has(e)?y(e,(0,u.getLocalListSymbols)(e)):(0,h.fetch)((0,
_.watchlistUrl)(`/api/v1/symbols_list/colored/${e}/append/`),{method:"POST",body:JSON.stringify(t),credentials:"include",headers:{"Content-Type":"application/json"}}).then(_.handleJSON)}(e,t))}replaceSymbols(e,t){return 0===t.length?Promise.resolve(null):(g.logNormal(`Sending request to replace symbols in ${e}-list: ${t}`),y(e,t))}resetSymbols(e){return 0===e.length?Promise.resolve():(g.logNormal(`Sending request to reset symbols: ${e}`),function(e){return(0,h.fetch)((0,_.watchlistUrl)("/api/v1/symbols_list/colored/bulk_remove/"),{method:"POST",body:JSON.stringify(e),credentials:"include",headers:{"Content-Type":"application/json"}}).then(_.handleJSON)}(e))}resetAll(){return g.logNormal("Sending request to reset ALL symbols"),(0,h.fetch)((0,_.watchlistUrl)("/api/v1/symbols_list/colored/"),{method:"DELETE",credentials:"include"}).then(_.handleJSON)}renameList(e,t){return g.logNormal(`Sending request to rename ${e}-list: ${t}`),function(e,t){return(0,h.fetch)((0,_.watchlistUrl)(`/api/v1/symbols_list/colored/${e}/rename/`),{method:"POST",body:JSON.stringify({name:t}),credentials:"include",headers:{"Content-Type":"application/json"}}).then(_.handleJSON)}(e,t)}shareList(e,t){return g.logNormal(`Sending request to share ${e}-list: ${t}`),(0,S.shareMarkedList)(e,t)}changeDescription(e,t){return g.logNormal(`Sending request to change description ${e}-list: ${t}`),function(e,t){return(0,h.fetch)((0,_.watchlistUrl)(`/api/v1/symbols_list/colored/${e}/update_meta/`),{method:"POST",body:JSON.stringify({description:t}),credentials:"include",headers:{"Content-Type":"application/json"}}).then(_.handleJSON)}(e,t)}renameSeparator(e,t,s){return g.logNormal(`Sending request to rename separator ${e}-list: ${t} to ${s}`),async function(e,t,s){return(0,m.commonRenameSeparator)(e,"colored",t,s)}(e,t,s)}}var b=s(666054),f=s(526225),C=(s(659863),s(306388)),v=s(837657),w=s(494966),L=s(111495),N=s(400353),k=s(448806),O=s(691840),E=s(264006),x=s(246093),T=s(231780),M=s(125226);let D;function P(){return D||((0,M.isFeatureEnabled)("set_limit_to_1000_for_colored_lists")?1e3:500)}const U=(0,a.getLogger)("MarkedSymbols.Model");function B(e){return e.markedLists}class A{constructor(e){this._promise=(0,C.initSymbolListService)(),this._service=null,this._executor=null,this._subscription=null,this._connectionStatus=null,this._recover=!1,this._synchronize=async e=>{let t,s;null!==this._executor&&(this._executor.destroy(),this._executor=null,U.logNormal("Executor was destroyed."));try{this._recover&&await(0,f.syncUserData)("marked-symbols");const[n]=await Promise.all([this._api.getLists(),this._promise]);t=await this._resolve(n),s=Date.now(),e.assert()}catch(e){if(e instanceof Error){if(U.logError(`Sync symbols error: ${e.message}`),e.message===T.ROUTINE_CANCELLED_MESSAGE)return;if("ApiError:not_authenticated"===e.name)return this._recover||await(0,f.syncUserData)("marked-symbols"),void(0,O.showSignModal)({feature:"flaggedSymbols"})}throw e}this._recover=!1;const{store:i}=(0,n.ensureNotNull)(this._service);this._createExecutor()
;const r=this._synchronizationService.getState(),l=null!==r?$(r):null;if(null!==l&&l>=s)return;const a=(0,o.setup)({lists:t.map((e=>({name:e.name??null,description:e.description??null,color:e.color,symbols:e.symbols,shared:e.shared,collapsedSeparators:e.collapsedSeparators,persistedState:e.persistedState}))),timestamp:s});i.dispatch(a)},this._handleChange=()=>{if(this._synchronizationService.isDestroyed())return;const{store:e}=(0,n.ensureNotNull)(this._service),t=(0,n.ensureNotNull)(B(e.getState()));if(this._synchronizationService.getState()!==t)try{this._opts.onChange?.(t,(0,n.ensureNotNull)(this._synchronizationService.getState()))}finally{this._synchronizationService.setState(t)}},this._handleExecutorError=(e,t)=>{"ApiError:plan_symbols_limit_reached"!==t.name?this._connectionStatus===b.ConnectionStatus.Open?this._synchronizationService.isDestroyed()||(U.logError(`Failed to execute ${e.type}`),this._recover=!0,this._synchronizationService.syncSymbols()):(0,E.showSimpleDialogInstance)({title:c.t(null,void 0,s(191056)),text:t.message},x.Warning):(0,k.openPaywall)({feature:"watchlistSymbols"})},this._opts=e,this._api=e.api||new p,this._session=e.quoteSession||(0,L.getQuoteSessionInstance)("simple"),this._synchronizationService=new T.SymbolListSynchronizationService({synchronize:this._synchronize,event:e.event,state:null,getTimestamp:$,loggerName:"MarkedSymbolsListModel"}),this._restrictedMarkSymbols=function(e){const{limit:t,colors:s,onLimit:n,onRestrictedColor:l,selector:a}=e;return e=>(c,h)=>{const u=h(),d=a(u),{color:m,symbols:_,separators:y}=e;if(null!==m){const e=d.lists.byColor[m]?.symbols??[],o=new Set(e),a=i.qualified.castMany([]);for(const e of new Set(_))!y&&(0,r.isSeparatorItem)(e)||o.has(e)||a.push(e);if(!s().includes(m))return void l();if(a.length&&a.length+o.size>t())return void n()}c((0,o.markMany)(e))}}({selector:e=>(0,n.ensureNotNull)(B(e)),limit:e.limit??(()=>P()),onLimit:()=>{U.logNormal("LimitReached"),this._opts.onLimit?.()},colors:e.colors??(()=>o.LIST_COLORS.filter(z)),onRestrictedColor:()=>{this._opts.onRestrictedColor?.()}}),this._promise.then((e=>{if(this._synchronizationService.isDestroyed())return;this._service=e;const{store:t}=e;this._synchronizationService.setState((0,n.ensureNotNull)(B(t.getState()))),this._subscription=t.subscribe(this._handleChange)})),this._synchronizationService.connect()}destroy(){this._synchronizationService.destroy(),this._subscription&&this._subscription(),this._executor&&this._executor.destroy()}getSymbolsByColor(e){if(null===this._service)return[];const{store:t}=this._service,s=B(t.getState());return null===s?[]:(0,o.getSymbolsByColor)(s,e)??[]}getLists(){return o.LIST_COLORS.reduce(((e,t)=>(e.set(t,new Set(this.getSymbolsByColor(t))),e)),new Map)}setSymbolsColor(e,t){if(U.logNormal(`Set symbols color ${t}`),null===this._service)return;const s=this._restrictedMarkSymbols({symbols:e,color:t,separators:!1});this._service.store.dispatch(s)}markMany(e){if(U.logNormal(`Mark many symbols: ${e.color}`),null===this._service)return
;const t=this._restrictedMarkSymbols(e);this._service.store.dispatch(t)}getSymbolColor(e){if(null===this._service)return null;const{store:t}=this._service,s=B(t.getState());return null===s?null:(0,o.getSymbolColor)(s,e)}clearAllSymbolsColor(){U.logNormal("Clear all symbols color"),null!==this._service&&this._service.store.dispatch((0,o.reset)({}))}syncSymbols(){return this._synchronizationService.syncSymbols()}anonymize(){null!==this._service&&this._service.store.dispatch((0,o.setup)({timestamp:Date.now(),lists:[]}))}connect(){return this._synchronizationService.connect()}closeConnection(){return this._synchronizationService.closeConnection()}_resolve(e){const t=new Set;for(const s of e)if(void 0!==s.symbols)for(const e of s.symbols){if((0,v.isSeparatorItem)(e))continue;(0,w.safeShortName)(e)===e&&t.add(e)}const s=Array.from(t).map((e=>this._session.snapshot(e).then((t=>t.pro_name||e),(()=>e)).then((t=>[e,t]))));return Promise.all(s).then((t=>{const s=new Map(t);return e.map((e=>{const{symbols:t,collapsedSeparators:n}=(0,u.localCollapseStateFromRemoteSymbols)(e.symbols??[]);return{id:e.id,name:e.name,description:e.description,color:e.color,shared:e.shared,created:e.created,modified:e.modified,type:e.type,active:e.active,symbols:t.map((e=>s.get(e)??e)),collapsedSeparators:n,persistedState:e}}))}))}_createExecutor(){const{store:e}=(0,n.ensureNotNull)(this._service);this._executor=new l({root:e,selector:e=>(0,n.ensureNotNull)(B(e)),api:this._api,onError:this._handleExecutorError,onWarn:e=>{U.logWarn(e)}}),U.logNormal("Executor was created")}}function z(e){return o.ListColor.Red===e||(0,N.enabled)("MULTIFLAGGED_SYMBOLS_LISTS")}function I(e){return!!z(e)||((0,k.openPaywall)({feature:"flaggedSymbols"}),!1)}function $(e){return e.timestamp}},250447:(e,t,s)=>{"use strict";s.r(t),s.d(t,{MarkedSymbolsListService:()=>u,getMarkedSymbolsListServiceInstance:()=>d});var n=s(481251),o=s(444372),i=s(989191),r=s(105205),l=s(779923),a=s(825131),c=s(448806),h=s(400353);class u{constructor(e){this._symbolChangeHandlers=new Map,this._listChangeHandlers=[],this._initHandlers=[],this._sync=null,this._inited=!1,this._handleChange=(e,t)=>{if(e.lists!==t.lists){this._listChangeHandlers.forEach((s=>{try{s(e,t)}catch{}}));for(const[s,n]of Array.from(this._symbolChangeHandlers.entries())){const o=(0,i.getSymbolColor)(e,s),r=(0,i.getSymbolColor)(t,s);o!==r&&n.forEach((e=>{try{e(o,r)}catch{}}))}}},this._onLoginStateChange=()=>{let e;this._model.closeConnection(),window.is_authenticated?(this._model.connect(),e=this._syncSymbols()):(this._model.anonymize(),this._inited=!1,e=Promise.resolve()),e.then(this._fireInit)},this._fireInit=()=>{this._initHandlers.forEach((e=>e()))},this._runWithSync=e=>{this._sync?this._sync.then(e):e()},this._handleRestrictedColor=()=>{(0,c.openPaywall)({feature:"flaggedSymbols"})},this._limit=()=>{const e=(0,h.getConfig)("WATCHLIST_SYMBOLS")?.limit;return void 0!==e&&e<(0,r.getSymbolsLimit)()?e:(0,r.getSymbolsLimit)()},this._handleLimit=()=>{const e=(0,h.getConfig)("WATCHLIST_SYMBOLS")?.limit;void 0!==e&&e<(0,
r.getSymbolsLimit)()?(0,c.openPaywall)({feature:"watchlistSymbols"}):(0,l.showWarning)({title:o.t(null,void 0,s(176945)),text:o.t(null,{replace:{limit:String((0,r.getSymbolsLimit)())}},s(757473))},null)},this._model=new r.MarkedSymbolsListModel({api:e?e.api:void 0,quoteSession:e?e.quoteSession:void 0,onChange:this._handleChange,limit:e?.limit??this._limit,onLimit:this._handleLimit,onRestrictedColor:this._handleRestrictedColor,colors:e?.colors,event:"marked-symbols"}),this._subscribeLoginStateChange(),this._syncSymbols().then(this._fireInit)}getSymbolsByColor(e){return this._model.getSymbolsByColor(e)}setSymbolsColor(e,t){0!==e.length&&this._runWithSync((()=>{this._model.setSymbolsColor(e,t)}))}getSymbolColor(e){return this._model.getSymbolColor(e)}markMany(e){this._runWithSync((()=>{this._model.markMany(e)}))}clearAllSymbolsColor(){this._runWithSync((()=>{this._model.clearAllSymbolsColor()}))}adjustSymbolsColors(e){const t=new a.ColorManager({context:a.ColorContext.SymbolMarker}),s=!e.map((e=>this.getSymbolColor(e))).includes(null);this.setSymbolsColor(e,s?null:t.getColor())}onSymbolChange(e,t){const s=this._symbolChangeHandlers.get(e);s?s.push(t):this._symbolChangeHandlers.set(e,[t])}offSymbolChange(e,t){const s=this._symbolChangeHandlers.get(e);if(s){const n=s.filter((e=>e!==t));n.length>0?this._symbolChangeHandlers.set(e,n):this._symbolChangeHandlers.delete(e)}}onListChange(e){this._listChangeHandlers.push(e)}offListChange(e){this._listChangeHandlers=this._listChangeHandlers.filter((t=>t!==e))}onInit(e){this._initHandlers.push(e)}offInit(e){this._initHandlers=this._initHandlers.filter((t=>t!==e))}destroy(){this._model.destroy(),this._unsubscribeLoginStateChange()}isInited(){return this._inited}_subscribeLoginStateChange(){window.loginStateChange&&window.loginStateChange.subscribe(this,this._onLoginStateChange)}_unsubscribeLoginStateChange(){window.loginStateChange&&window.loginStateChange.unsubscribe(this,this._onLoginStateChange)}_syncSymbols(){if(window.is_authenticated){this._sync=this._model.syncSymbols();const e=()=>{this._sync=null,this._inited=!0};return this._sync.then(e).catch(e)}return Promise.resolve()}}const d=(0,n.default)((()=>new u))},6015:(e,t,s)=>{"use strict";s.d(t,{SymbolMarkerSettings:()=>n,SymbolsFilterSettings:()=>o});var n,o,i=s(989191),r=s(62802);!function(e){const t="default_symbol_marker_color";e.getDefaultColor=function(){return r.getValue(t,i.ListColor.Red)},e.setDefaultColor=function(e){r.setValue(t,e,{forceFlush:!0})}}(n||(n={})),function(e){const t="default_symbols_filter_color",s="marked_symbols_filter";e.getDefaultColor=function(){return r.getValue(t,i.ListColor.Red)},e.setDefaultColor=function(e){r.setValue(t,e,{forceFlush:!0})},e.setIsActive=function(e){r.setValue(s,e,{forceFlush:!0})},e.getIsActive=function(){return r.getBool(s,!1)}}(o||(o={}))},540975:(e,t,s)=>{"use strict";s.d(t,{Button:()=>c});var n=s(50959),o=s(311239);function i(e="default"){switch(e){case"default":return"primary";case"stroke":return"secondary"}}function r(e="primary"){switch(e){case"primary":return"brand"
;case"success":return"green";case"default":return"gray";case"danger":return"red"}}function l(e="m"){switch(e){case"s":return"xsmall";case"m":return"small";case"l":return"large"}}function a(e){const{intent:t,size:s,appearance:n,useFullWidth:o,icon:a,...c}=e;return{...c,color:r(t),size:l(s),variant:i(n),stretch:o}}function c(e){return n.createElement(o.SquareButton,{...a(e)})}},640027:(e,t,s)=>{"use strict";s.d(t,{useIsMounted:()=>o});var n=s(50959);const o=()=>{const e=(0,n.useRef)(!1);return(0,n.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e}},591152:(e,t,s)=>{"use strict";s.d(t,{getOwnSharedList:()=>h,getSharedList:()=>c,shareCustomList:()=>a,shareMarkedList:()=>l});var n=s(989191),o=s(954912),i=s(658583),r=s(822714);function l(e,t){return(0,o.fetch)((0,i.watchlistUrl)(`/api/v1/symbols_list/colored/${e}/share/`),{method:"POST",body:JSON.stringify({shared:t}),credentials:"include",headers:{"Content-Type":"application/json"}}).then(i.handleJSON).then(r.convertToMarkedSymbolList)}function a(e,t){return(0,o.fetch)((0,i.watchlistUrl)(`/api/v1/symbols_list/custom/${e}/share/`),{method:"POST",body:JSON.stringify({shared:t}),credentials:"include",headers:{"Content-Type":"application/json"}}).then(i.handleJSON).then(r.convertToCustomSymbolList)}function c(e){return(0,o.fetch)((0,i.watchlistUrl)(`/api/v1/symbols_list/shared/${e}/`),{method:"GET",credentials:"include"}).then(i.handleJSON).then(r.convertToSymbolList)}function h(e,t){return(0,n.isListColor)(e)?(0,o.fetch)((0,i.watchlistUrl)(`/api/v1/symbols_list/colored/${e}`),{method:"GET",credentials:"include",signal:t}).then(i.handleJSON):(0,o.fetch)((0,i.watchlistUrl)(`/api/v1/symbols_list/custom/${e}`),{method:"GET",credentials:"include",signal:t}).then(i.handleJSON)}},623895:(e,t,s)=>{"use strict";function n(e){return"html"in e?{html:e.html}:"text"in e?{content:e.text}:{content:e.content}}s.d(t,{getContent:()=>n})},246093:(e,t,s)=>{"use strict";s.d(t,{Warning:()=>l});var n=s(50959),o=s(444372),i=s(927582),r=s(623895);function l(e){const{title:t,closeOnOutsideClick:l,onClose:c=()=>{},backdrop:h,showCloseButton:u,dataQaId:d}=e,m=(0,r.getContent)(e);return n.createElement(i.SimpleDialog,{...m,title:t||o.t(null,void 0,s(966719)),onClose:c,backdrop:h,actions:a(e),dataName:"warning-dialog",dataQaId:d,closeOnOutsideClick:l,showCloseButton:u})}function a(e){const{buttonText:t,intentButton:n,actions:i,onConfirm:r}=e,l=[{name:"ok",title:t||o.t(null,void 0,s(819295)),intent:n,handler:({dialogClose:e})=>{r?.(),e()}}];return i&&i.forEach((e=>l.push(e))),l}},264006:(e,t,s)=>{"use strict";s.d(t,{showSimpleDialogInstance:()=>c});var n=s(50959),o=s(650151),i=s(670797),r=s(322654),l=s(631456);const a=new r.DialogsOpenerManager;function c(e,t,s){const{title:r}=e;let c=`${r}_`;if(c+="text"in e?e.text:"html"in e?e.html:e.id,a.isOpened(c))return(0,o.ensureDefined)(a.getDialogPayload(c)).closeHandler;const h=document.createElement("div"),u=()=>{e.onClose?.(),d.unmount(),a.setAsClosed(c)},d=(0,l.createReactRoot)(n.createElement(i.SlotContext.Provider,{value:s||null},n.createElement(t,{
...e,onClose:u})),h);return a.setAsOpened(c,{closeHandler:u}),u}},303616:(e,t,s)=>{"use strict";s.d(t,{SimpleDialogContext:()=>n});const n=s(50959).createContext({isSmallTablet:!1,dialogCloseHandler:()=>{}})},927582:(e,t,s)=>{"use strict";s.d(t,{SimpleDialog:()=>w});var n=s(50959),o=s(497754),i=s(897782),r=s(251954),l=s(62526),a=s(470316),c=s(18182),h=s(332450),u=s(642709),d=s(150881),m=s(540975),_=s(265005),y=s(650151),S=s(640027),g=s(670797),p=s(303616),b=s(843202);function f(e){const{disabled:t,name:s,title:i,appearance:r,intent:l,handler:a,reference:c,dataQaId:h,type:u,className:d}=e,{isSmallTablet:f,dialogCloseHandler:C}=(0,n.useContext)(p.SimpleDialogContext),v=(0,y.ensureNotNull)((0,n.useContext)(g.SlotContext)),w=(0,S.useIsMounted)(),[L,N]=(0,n.useState)(!1);return n.createElement(m.Button,{type:u,disabled:t,reference:c,className:o(b.actionButton,d,f&&b.small),name:s,size:f?"l":void 0,appearance:r,intent:l,"data-qa-id":h,onClick:function(){if(L)return;const e=a({dialogClose:C,innerManager:v});e&&(N(!0),e.then((()=>{w.current&&N(!1)})))}},n.createElement("span",{className:o(L&&b.hiddenTitle)},i),L&&n.createElement(_.Loader,{color:"primary"===l?"black":"white"}))}var C=s(507720),v=s(115937);function w(e){const{title:t,onClose:s,actions:m,dataName:_,dataQaId:y,popupDialogClassName:S,contentClassName:g,wrapperClassName:b,backdrop:w,closeOnOutsideClick:L=!0,showCloseButton:N=!0,closeOnEscapePress:k=!0,events:O=!0,centeredOnResize:E,shouldAutoClose:x}=e;(0,n.useEffect)((()=>(r.subscribe(h.CLOSE_POPUPS_AND_DIALOGS_COMMAND,s,null),()=>{r.unsubscribe(h.CLOSE_POPUPS_AND_DIALOGS_COMMAND,s,null)})),[s]);const[T,M]=(0,n.useState)(!0),D=(0,n.useRef)(null),P=(0,n.useRef)(null);return(0,n.useEffect)((()=>(window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A)})),[P,E]),n.createElement(c.MatchMedia,{rule:u.DialogBreakpoints.TabletSmall},(r=>n.createElement(p.SimpleDialogContext.Provider,{value:{isSmallTablet:r,dialogCloseHandler:s}},n.createElement(l.PopupDialog,{className:o(v.popupDialog,S),componentRef:P,isOpened:T,backdrop:w,dataQaId:y??void 0,onClickBackdrop:O?B:void 0,onClickOutside:L?B:void 0,onKeyDown:U,autofocus:!0,fixedBody:!0},n.createElement("div",{className:o(v.wrap,b),"data-name":_,"data-qa-id":y},n.createElement("div",{className:o(v.main,!N&&v.marginWithoutCloseButton,r&&v.small)},t&&n.createElement("div",{className:o(v.title,r&&v.small)},t),function(t){if("html"in e)return n.createElement(d.TouchScrollContainer,{className:o(v.content,t&&v.small,v.html,g),dangerouslySetInnerHTML:{__html:e.html}});if("content"in e)return n.createElement(d.TouchScrollContainer,{className:o(v.content,t&&v.small,g)},e.content);return null}(r),m&&m.length>0&&n.createElement("div",{className:o(v.footer,r&&v.small)},m.map(((e,t)=>n.createElement(f,{...e,key:e.name,dataQaId:`${e.name}-btn`,reference:0===t?D:void 0}))))),N&&n.createElement(i.NavButton,{"aria-label":"close",size:"medium",preservePaddings:!0,className:o(v.close,r&&v.small),icon:C,onClick:B,"data-name":"close","data-role":"button"}))))))
;function U(e){switch((0,a.hashFromEvent)(e)){case 27:T&&k&&(e.preventDefault(),s());break;case 13:const t=document.activeElement;if(e.defaultPrevented||t instanceof HTMLAnchorElement||t instanceof HTMLButtonElement&&"submit"!==t.type)return;if(T&&m&&m.length){e.preventDefault();const t=D.current;t&&t.click()}}}function B(){x&&M(!1),s()}function A(){E&&P.current?.centerAndFit?.()}}},231780:(e,t,s)=>{"use strict";s.d(t,{ROUTINE_CANCELLED_MESSAGE:()=>c,SymbolListSynchronizationService:()=>h});var n=s(262078),o=s(666054),i=s(735566);s(659863);const r=6e5,l=3e4,a=3e4,c="ROUTINE_CANCELLED";class h{constructor(e){this._destroyed=!1,this._state=null,this._sync=null,this._disconnectTimestamp=null,this._prevConnectionStatus=null,this._onPushStreamChange=e=>{window.user&&window.user.session_hash!==e.session_hash?n.pushStreamMultiplexer.ownPushStream()?(this._logger.logNormal("Cross browser sync"),this.syncSymbols(e)):this._logger.logDebug("Sync skipped: on secondary tab"):this._logger.logDebug("Sync skipped: session hash")},this._onPushStreamStatus=e=>{const t=Date.now();if(e===o.ConnectionStatus.Open&&this._prevConnectionStatus===o.ConnectionStatus.Closed){this._prevConnectionStatus=e;const s=null===this._disconnectTimestamp?0:t-this._disconnectTimestamp;if(this._disconnectTimestamp=null,!window.is_authenticated)return void this._logger.logDebug("Sync skipped: is not authenticated");if(!n.pushStreamMultiplexer.ownPushStream())return void this._logger.logDebug("Sync skipped: on secondary tab");if(s<r)return void this._logger.logDebug("Sync skipped: short disconnection");this._reconnectTimeout=setTimeout((()=>{const e=null!==this._state?this._getTimestamp(this._state):null;null===e||e<t?(this._logger.logNormal("Reconnect sync"),this.syncSymbols()):this._logger.logNormal("Reconnect sync handled by another tab")}),Math.random()*a+l)}else e===o.ConnectionStatus.Closed&&(this._disconnectTimestamp=Date.now(),this._prevConnectionStatus=e,clearTimeout(this._reconnectTimeout))};const{event:t,state:s,synchronize:c,getTimestamp:h,loggerName:u}=e;this._event=t,this._synchronize=c,this._state=s,this._getTimestamp=h,this._logger=(0,i.getLogger)(`${u}.SymbolListSynchronizationService`),this.connect()}destroy(){this._destroyed=!0,this._sync=null,this.closeConnection()}syncSymbols(e){if(null===this._sync){const t=this._sync=this._synchronize({assert:()=>{if(this._sync!==t)throw new Error(c)},cancel:()=>{this._sync=null}},e).then((()=>{this._sync=null}),(e=>{throw this._sync=null,e}))}return this._sync}connect(){this._subscribeOnPushStream()}closeConnection(){this._unsubscribeOnPushStream()}isDestroyed(){return this._destroyed}getState(){return this._state}setState(e){this._state=e}_subscribeOnPushStream(){n.pushStreamMultiplexer.on(this._event,this._onPushStreamChange),n.pushStreamMultiplexer.onPrivateStatus(this._onPushStreamStatus)}_unsubscribeOnPushStream(){n.pushStreamMultiplexer.off(this._event,this._onPushStreamChange),n.pushStreamMultiplexer.offStatus(this._onPushStreamStatus),clearTimeout(this._reconnectTimeout),
this._prevConnectionStatus=null}}},507720:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17" fill="currentColor"><path d="m.58 1.42.82-.82 15 15-.82.82z"/><path d="m.58 15.58 15-15 .82.82-15 15z"/></svg>'}}]);